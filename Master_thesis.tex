\documentclass[a4paper,12pt]{extarticle}
    \usepackage{amsmath}
    \usepackage{nccmath}
    \usepackage{amsfonts}
    \usepackage{lscape}
    \usepackage[utf8]{inputenc}
    \usepackage{titlepic}
    \usepackage{stackengine}
    \usepackage{lipsum}
    \linespread{1.15} 
    \usepackage[]{graphicx}
    \usepackage[section]{placeins}
    \usepackage{booktabs}
    \usepackage{cite}
	\usepackage{float}
	\usepackage{caption}
	\usepackage{adjustbox}
    \usepackage{subcaption}
    \usepackage{multirow}
    \usepackage[a4paper,top=1in, bottom=1.1in, left=1.1in, right=1.1in]{geometry}
    \usepackage{fancyhdr}
    \usepackage{relsize}
    \usepackage{tikz}
    \usetikzlibrary{shapes.geometric,arrows}
	\makeatletter
    \setlength{\@fptop}{0pt}
    \makeatother
    \tikzstyle{startstop} = [rectangle, rounded corners, minimum width = 4cm, minimum height=1cm, text centered,text width = 5cm, draw = black, fill=white!10]    
     \tikzstyle{process} = [rectangle,  minimum width = 5cm, minimum height=1.5cm, text centered, text width = 5cm,draw = black, fill = white!10]  
	 \tikzstyle{decision} = [diamond, minimum width = 4cm, minimum height=1cm, text centered,text width = 3cm, draw = black, fill = white!10]  
     \tikzstyle{arrow} = [thick,->,>=stealth]  


\usepackage{titling}
\pretitle{\begin{center}\fontsize{18bp}{18bp}\selectfont}
    \posttitle{\vspace{25bp}\par\includegraphics[width=60mm]{logo.png}\par\end{center}}
\preauthor{\begin{center}\fontsize{14bp}{14bp}\selectfont}
    \postauthor{\par\end{center}}
\predate{\begin{center}}
    \postdate{\par\end{center}}  

\title{\LARGE{\textbf{Development and implementation of material subroutine for fibre reinforced plastics in a commercial FEM software}}\\[0.7cm]\smaller \textbf{Master thesis \\[0.5cm] Winter semester 2018/19}\vspace*{1cm}}


\author{
\vspace{2cm}
\large{Presented by: Arun prakash Ganapathy}
\\[0.4cm]
\large{Supervised by: Dr.-Ing Dominik Laveuve}
\\[0.4cm]
\large{Mat.Nr: 63876}
\\[0.4cm]
\large{E-mail: arun-prakash.ganapathy@student.tu-freiberg.de}}
\date{}
\begin{document}
\maketitle
\newpage
\section{Introduction}
\subsection{Background and motivation}
\indent\indent Composite materials are made of two or more dissimilar materials of different physical or chemical properties when combined, create a material with properties unlike the individual constituent materials. The earliest use of composite materials date back to 3400 B.C when Mesopotamians glued wood strips at different angles to create plywood. Another notable example is the bow made by Mongols during 1200 A.D, which is made from a combination of bamboo, wood, cattle tendons and silk bonded with natural resin. In the early, 1900s bakelite based composites were developed for its non-conductivity and heat resistant properties and widely used in industrial and consumer applications. Now a days advanced composite materials are widely used in structural design in various industries such as aerospace, automobile, marine, petrochemical etc., due to their superior properties over traditional engineering materials.\\
\begin{figure}[htbp]
\begin{center}
\includegraphics[width=0.8\textwidth]{{composite plane.jpg}}
 \caption{Composite materials used in a Boeing 787 'Dreamliner'}
 \label{fig:Composite plane}
\end{center}
\end{figure}\\
 Composite material are attractive because of their high strength, stiffness, high stiffness-to-density ratio, light weight properties etc., Another important reason for using composite materials is the ability to tailor the stiffness and strength to specific design load flexibly. Despite their superior physical properties, composite materials are fragile and can be easily damaged from number of sources, both during initial processing and in operation. Since composite materials possess elastic brittle properties with negligible margin of safety through ductility as offered by metals and accumulate damage before structural collapse, the development of damage must be understood for predicting failure of such materials. For example fibre-reinforced plastics exhibit local damage such as fibre breakage, matrix cracks, fibre matrix debonds etc., under normal operating conditions which may contribute to the failure. Therefore the ability to predict the initiation and growth of damage is important for predicting the performance of the composite materials for safe and reliable use of such materials. Continuum damage mechanics (CDM) has been considered as a reliable candidate for creating numerical models which predict the onset and evolution of the damage in the composite materials.
\newpage
\vspace*{4cm}
\section{Continuum damage mechanics}
\indent\indent\indent Continuum damage mechanics (CDM) is a theory for analyzing damage and fracture processes in materials from continuum mechanics point of view. Continuum damage mechanics (CDM) provides a continuum perspective for microflaws initiation, propagation, and their coalescence that eventually results in macroscopic faults and fractures. CDM uses state variables to represent the effect of damage on the stiffness and remaining life of the material that is damaging as a result of load and ageing. A Damage activation function is required to predict the initiation of damage. Damage evolution does not progress spontaneously after initiation therefore a mathematical model is required.  

\subsection{Damage}
\indent\indent\indent  Consider a body B of Fig. \ref{fig:Damage}  where a crack of length a has developed due to an external load F.  If we take an arbitrary point P($x$) near the crack tip, a number of microscopic cavities or microcracks would be observed around the region.
These cavities can be nucleated usually as a result of breakage of atomic bonds, or of some defects in atomic array. From microscopic point of view, fracture of materials is a process of nucleation of microcavities or microcracks due to the breakage of atomic bonds. From macroscopic point of view, it is a process of extension of cracks brought about by the coalescence of these microcracks.
\begin{figure}[htbp]
\begin{center}
\includegraphics[width=0.5\textwidth]{{1. Damage.png}}
 \caption{Scales of damage observation}
 \label{fig:Damage}
\end{center}
\end{figure}
 From mesoscopic point of view, which exists between microscopic and macroscopic scale, it is a process of nucleation, growth and the coalescence of microscopic cavities leads to the initiation of macroscopic crack. The development of microscopic, mesoscopic and the macroscopic processes of fracture in materials together with the resulting deterioration in their mechanical properties is called damage. Continuum damage mechanics, in particular, aims at the analysis of the damage development in mesoscopic and macroscopic fracture processes in the framework of continuum mechanics.

The seperation of atomic bonds is induced either by shear or tensile decohesion. However the separation of material at the microscopic level consists of four damage mechanisms namely Cleavage, Growth and Coalescence of Microvoids, Glide plane decohesion and Void Growth due to Grain-Boundary diffusion.  The aspects of damage vary largely by difference in materials and loading conditions. The damage may be classified phenomenologically as follows
\begin{itemize}
\item Ductile Damage
\item Brittle Damage
\item Creep Damage
\item Low Cycle Fatigue
\item Very Low Cycle Fatigue
\item High Cycle fatigue damage
\item Very High Cycle fatigue damage
\item Creep Damage
\end{itemize}
\subsection{Representative Volume Element(RVE)}
\indent\indent\indent  In order to discuss the effects of microscopic discontinuities in  a material by means of CDM we must homogenize the mechanical effects of microstructure and represent them as a macroscopic continuous field in the material. For this purpose we take a small region of a mesoscale around the material point P($x$) in a body B as showin in Fig. \ref{fig:Damage}. We assume that the  material with discontinuous structures in this region can be statistically homogeneous and the mechanical state of the material in this region can be represented by the statistical average of the mechanical variables in that region. This region is said to be the Representative Volume Element(RVE). For such RVE, the following two conditions must be satisfied:
\begin{itemize}
\item  For the material in the RVE to be statistically homogeneous, the RVE should be large enough to contain a sufficient number of discontinuities
\item In order to represent a non-uniform macroscopic mechanical field by means of a continuum, the size of RVE should be sufficiently small so that the variation of the macroscopic variable in it may be insignificantly small
\end{itemize}
The size of RVE depends on the microstructure of the relevant material and their typical sizes are as follows
\begin{itemize}
\item Metals and ceramics  \;    -    \; 0.1$mm^3$
\item Polymer and composites \;   -   \; 1$mm^3$
\item Timber\; - \; 10$mm^3$
\item Concrete \; - \; 100$mm^3$
\end{itemize}

\subsection{Concept of Continuum damage mechanics (CDM)}
\indent\indent\indent The basic concept of CDM is that the  microstructural defects in a material can be represented by a set of damage variables.  Continuum damage mechanics first represent the damage state of a material in terms of properly defined damage variables and then describe the mechanical behaviour of the damaged material and then development of damage by use of these damage variables. The mechanical behaviour of a damaged material can be described using the notion of effective stress, together with hypothesis of mechanical equivalence between damaged and undamaged material. The concept of effective stress and mechanical equivalence will be discussed in the following sections.
\subsubsection{Modelling by Effective Area Reduction}
Let us consider a body B of Fig. (\ref{fig:Damage2}) and take a representative volume element(RVE) at an arbitrary point $P(x)$ in B. If the total void area in $dA$ is  $ dA_{D} $, the mechanical effect of $dA$ will be decreased by $dA_{D}$. Then the area,
\begin{equation}
  d\tilde{A} = dA  - dA_{D}
  \label{eqn:da} 
\end{equation}
may be interpreted as the area which carries the internal force and is called as $effective$ $area$. Thus the damage variable D can be specified as 
\begin{equation}
 \label{eqn:D}
  D = \frac{dA - d\tilde{A}}{dA} = \frac{dA_{D}}{dA}
\end{equation}
where the damage variable D takes value between 0 and 1 ($0 \leq D \leq 1$). $D = 0$ representing initial undamaged state and $D=1$ represents fully damaged state.
\begin{figure}[htbp]
\begin{center}
\includegraphics[width=0.8\textwidth]{{Damage2.png}}
 \caption{Effective area reduction due to microcracks}
 \label{fig:Damage2}
 \end{center}
\end{figure}
Suppose a cylindrical bar of cross-sectional area $dA$ is subject to a tensile load $dF$ the actual load carrying area is $ d\tilde{A}$ rather than $dA$. According to eqn (\ref{eqn:da}) and (\ref{eqn:D}) the effective area $ d\tilde{A}$ is given by,
\begin{equation}
\label{eqn:da_t}
 d\tilde{A} = (1-D)dA
\end{equation}
The decrease in load-carrying area increase the effect of stress $\sigma$ induced by the external force $dF$. Due to eqn \ref{eqn:da_t} the magnified stress $\tilde{\sigma}$ is given by,
\begin{equation}
\label{eqn:sig_t}
\tilde{\sigma} = \frac{dF}{d\tilde{A}} = \frac{\sigma}{1 - D}
\end{equation} 

Since the stress $\tilde{\sigma}$ represents the effect of stress magnified by the net area reduction due to damage, it is called as $effective$ $stress$. From eqn (\ref{eqn:da_t}) and (\ref{eqn:sig_t}) we can postulate that the damaged cylindrical bar of Fig.(\ref{fig:Damage3}b) with the cross-sectional area $dA$ subject to force $dF$ is mechanically equivalent to the fictious undamaged bar of Fig.(\ref{fig:Damage3}c) which is subject to force $dF$ , has the cross-sectional area $ {d\tilde{A}} $ and hence stress has the stress $\tilde{\sigma}$  
\begin{figure}[htbp]
\begin{center}
\includegraphics[width=0.8\textwidth]{{3. Damage_cylinder.png}}
 \caption{Damage of bar under tensile load}
 \label{fig:Damage3}
 \end{center}
\end{figure}

\subsubsection{Modelling by variation of elastic modulus} 
\indent\indent\indent Since the development of microcracks induces the reduction in stiffness of material, the damage state can be characterized by variation in elastic modulus. Let us consider the bar (b) and (c) of Fig. (\ref{fig:Damage3}) are in damaged and fictitious undamaged state respectively. Then the elastic strain $\epsilon$ in the bar (c) caused by stress $\tilde{\sigma}$ should be equal to the $\epsilon$ of the bar (b) under stress $\sigma$; i.e.,\\
\begin{equation}
\label{eqn:sig_t2}
   \tilde{\sigma} = E_{0}\epsilon, \;\;  \sigma = E(D)\epsilon 
\end{equation}
\\
\begin{equation}
\label{eqn:epsilon}
\epsilon = \frac{\sigma}{E(D)} = \frac{\tilde{\sigma}}{E_{0}}
\end{equation}
where $E_{0}$ and $E(D)$ denote young's modulus of the material in the initial undamaged state and that in damaged state after loading, respectively. Therefore, eqn. (\ref{eqn:epsilon}) defines another effective stress\\
\begin{equation}
\label{eqn:epsilon2}
\epsilon = \frac{E_{0}}{E(D)}\sigma
\end{equation}
By combining Eqn. (\ref{eqn:sig_t}) and (\ref{eqn:epsilon}) we get,
\begin{equation}
\label{eqn:E(d)}
E(D) = (1 - D) E_{0}
\end{equation}
\begin{equation}
\label{eqn:D2}
D  = 1 - \frac{E(D)}{E_{0}}
\end{equation}
Therefore, the damage variable $D$ is characterized by the variation in Young's modulus $E(D)$. The modelling of damage by means of reduction in stiffness can be applied also the anisotropic damage of brittle materials like composite materials, concrete, rocks etc.,
\subsection{Mechanical representation of three dimensional damage state}
\indent\indent\indent The deformation of a material basically depends on the direction of applied stress or strain and hence it is an anisotropic phenomenon. Therefore different theories have been developed for modelling 3-D anisotropic damage phenomenon. Some fundamental theories that describes 3-D damage state are given below 
\subsubsection{Scalar Damage Variable}
\indent\indent\indent In case of random or isotropic distribution of microcracks or voids , the damage state is usually considered as isotropic. the damage state in this case may be represented by means of scalar damage variable D. When microvoids  have oriented distribution the damage state is anisotropic and the scalar damage variable cannot be applied accurately. However, when void density is small the global mechanical properties can be approximated as nearly isotropic. Thus isotropic damage theory based on isotropic damage variable has been often applied to 3-D problems of creep, elastic-plastic, ductile and fatigue damage
\subsubsection{Plural Scalar damage variables}
\indent\indent\indent A single scalar damage variable is often insufficient to describe the variation in mechanical properties of the damaged materials, even if the distribution of microcracks are isotropic. Plural scalar damage variables are often employed to characterize several different microscopic mechanisms of the relevant damage development.
\subsubsection{Vector damage variable}
\indent\indent\indent The damage state can be specified by the decrease in load carrying effective area due to void development. Hence it is easy to postulate a vector damage variable. Kachanov (1974, 1986) tried to extend the definition of damage to anisotropic damage by noting a surface element in an arbitrary direction $n$, he proposed a vector damage variable $ \omega = \omega_{n}n$, where $\omega_{n}$ is the effective area fraction. 
\subsubsection{Damage tensor of second order}
\indent\indent\indent In order to describe an anisotropic damage state, damage variable of second or higher order tensor is required. Eqn.(\ref{eqn:da_t}) suggests that the damage state (1 - D) is specified by the transformation of the surface element $dA$ of Fig. (\ref{fig:Damage3}b) of the damage state into the corresponding surface element $d\tilde{A}$ in the fictitious undamaged state of Fig.(\ref{fig:Damage3}c). 
\begin{figure}[htbp]
\begin{center}
\includegraphics[width=0.5\textwidth]{{4. Damage.png}}
 \caption{Surface element in RVE of a damaged material}
 \label{fig:Damage4}
 \end{center}
\end{figure}
In order to express damage as a second order tensor, we first consider an arbitrary surface element $PQR$ in RVE in the current damaged configuration $B_{t}$ of Fig.(\ref{fig:Damage4}a) . The unit normal vector and area of $PQR$ are denoted by $\nu$ and $dA$. We further postulate the fictitious undamaged configuration $B_{f}$ of Fig.(\ref{fig:Damage4}b) mechanically equivalent to $B_{t}$, and the surface element and its area vector are denoted by $\tilde{P}\tilde{Q}\tilde{R}$ and $\tilde{\nu}d\tilde{A}$ respectively. According to Eqn.(\ref{eqn:da_t}) the damage variable of second-order tensor $D$ should be defined by linear transformation from area vector $\nu dA$ in $B_{t}$ into $\tilde{\nu}d\tilde{A}$ in $B_{f}$, i.e.,
\begin{equation}
\label{eqn:second_order_tensor}
\tilde{\nu}d\tilde{A} = (I - D)\nu dA
\end{equation}
where $I$ is the second order identity tensor. Since the damage tensor $D$ is symmetric, it can be expressed by its spectral decomposition
\begin{equation}
\label{eqn:damage_2nd_order}
D = \sum_{i = 1}^{3} D_{i}n_{i}  \otimes D_{i}n_{i}
\end{equation}
where $D_{i}$ and $n_{i}$ are the principal value and principal direction of $D$. 

\subsection{Effective Stress Tensors}
\indent\indent\indent The effective stresses are  used to describe the mechanical behaviour of the damaged material. Some of the effective stresses postulated in damage mechanics are given below
\subsubsection{Effective Stress Tensor for Isotropic Damage}
\indent\indent\indent If the damage state is isotropic then the effective stress tensor of three-dimensional state is given by
\begin{equation}
\tilde{\sigma} = (1 - D)^{-1} \; \sigma
\end{equation}
where D is the scalar damage variable and $\sigma$ is the Cauchy stress tensor. This effective stress simplifies damage theory and can be applied to number of damage problems like ductile damage. But this cannot be applied to damage of significant anisotropy, such as brittle damage due to microcrack distribution\\
\subsubsection{Asymmetric Effective Stress Tensor for Anisotropic Damage}
\indent\indent\indent The increase in stress effect caused by the net area reduction in case of anisotropic damage is given by
\begin{equation}
\tilde{\sigma} = (I - D)^{-1} \; \sigma
\end{equation}
where I and D are second order identity tensor and the second order damage tensor respectively. In the actual development of anisotropic damage, the stress induced in RVE of damage material is asymmetric. But asymmetric stress tensor makes the numerical analysis complicated and thus different methods of symmetrization has been proposed. Few of them are described as follows

\subsubsection{Symmetrized Effective Stress Tensor for Anisotropic Damage 1 (Murakami and Ohno 1981)} 
\indent\indent\indent A simple symmetrization procedure of Eq.(\ref{eqn: Murakami and Ohno}), the symmetric part of the Cartesian decomposition of Eq.(\ref{eqn: Murakami and Ohno}) gives,
\begin{equation}
\label{eqn: Murakami and Ohno}
\tilde{\sigma} = \frac{1}{2} [(I - D)^{-1}\;\sigma + \sigma(I - D)^{-1}]
\end{equation}\\
\subsubsection{Symmetrized Effective Stress Tensor for Anisotropic Damage 2 (Cordebois and Sidoroff 1982a, b)}
\indent\indent\indent Another form of symmetrization was proposed by Cordebois and Sidoroff:
\begin{equation}
\label{eqn:Cordebois and Sidoroff }
\tilde{\sigma} =  (I - D)^{-1/2}\sigma(I - D)^{-1/2}
\end{equation}
where $\sigma$ and $D$ are co-axial. Moreover, unless the development of damage is large, the difference between these effective stresses are known to be insignificant.\\

\subsection{Matrix Representation of Damage effect tensors}\label{Matrix Representation of Damage effect tensors}
\indent\indent\indent The general form of an effective stress tensor $\tilde{\sigma}$ is given by the damage effect tensor $\mathbb{M}$ and the corresponding Cauchy stress tensor $\sigma$, i.e.,
\begin{equation}
\tilde{\sigma}  = \mathbb{M} \; :  \sigma 
\label{eqn:effective_stress_tensor} 
\end{equation}
It is convenient to express the tensors in the form of matrices and then execute the tensor operations as a matrix calculus.. To simplify this procedure, we take an orthonormal basis ${n_{i}}$ with principal directions $n_{i}$ of the second-order symmetric damage tensor $D$, and represent the the tensor in terms of their component to this basis. According to voigt notation, the second-order symmetric tensor $\sigma$ and the related effective stress $\tilde{\sigma}$ are expressed by column vector of six dimension:
\begin{equation}
   [\sigma_{P}]  \equiv  [\sigma_{11} \;\; \sigma_{22} \;\;\sigma_{33} \;\;\sigma_{12} \;\;\sigma_{13} \;\;\sigma_{23} ]^{T}
\end{equation}

\begin{equation}
   [\tilde{\sigma_{P}}]  \equiv  [\tilde{\sigma_{11}} \;\; \tilde{\sigma_{22}} \;\;\tilde{\sigma_{33}} \;\;\tilde{\sigma_{12}} \;\;\tilde{\sigma_{13}} \;\;\tilde{\sigma_{23}} ]^{T}
\end{equation}
\\
The damage effect tensor $\mathbb{M}$ can be represented as symmetric matrix. By representing first two indices $ij$ and the succeeding two indices $kl$ of the tensor by $p$ and $q$ ($p,q$ = 1,2,...,6), respectively, the components of $\mathbb{M}$
are expressed by a six by six matrix 
\\
\\
$$
[\mathbb{M}_{pq}] \equiv   
 \begin{bmatrix}
  M_{1111}\; & M_{1122}\; & M_{1133}\; & M_{1123}\; & M_{1131}\; & M_{1112} \\
  \\
  M_{2211}\; & M_{2222}\; & M_{2233}\; & M_{2223}\; & M_{2231}\; & M_{2212} \\
   \\
  M_{3311}\; & M_{3322}\; & M_{3333}\; & M_{3323}\; & M_{3331}\; & M_{3312} \\
   \\
  M_{2311}\; & M_{2322}\; & M_{2333}\; & M_{2323}\; & M_{2331}\; & M_{2312} \\
   \\
  M_{3111}\; & M_{3122}\; & M_{3133}\; & M_{3123}\; & M_{3131}\; & M_{3112} \\
   \\
  M_{1211}\; & M_{1222}\; & M_{1233}\; & M_{1223}\; & M_{1231}\; & M_{1212} 
   \\ 
 \end{bmatrix}
  $$
 \\

By means of the matrix representation, we have the matrix form
\begin{equation}
[\tilde{\sigma_{P}}] \equiv [\mathbb{M}_{pq}]\;: [\sigma_{P}]
\label{eqn:Matrix_rep_damage_effect_tensor}
\end{equation}
\\
Matrix representation of the damage effect tensor of Eq.(\ref{eqn:Matrix_rep_damage_effect_tensor}) is shown below
\\
$$
[\mathbb{M}_{pq}] \equiv   
 \begin{bmatrix}
   \frac{1}{\omega_{11}}  \; & 0 \; & 0 \; & 0 \; & 0\; & 0 \\
  \\
  0\; & \frac{1}{\omega_{22}}\; & 0\; & 0\; & 0\; & 0 \\
  \\
  0\; & 0 \; & \frac{1}{\omega_{33}}\; & 0\; & 0\; & 0 \\
  \\
  0\; & 0\; & 0\; & \frac{1}{\omega_{12}}\; & 0\; & 0 \\
  \\
  0\; & 0\; & 0\; & 0\; & \frac{1}{\omega_{23}}\; & 0 \\
  \\
  0\; & 0\; & 0\; & 0\; & 0\; & \frac{1}{\omega_{13}}  
  \\
 \end{bmatrix}
 \label{Damage_effect_tensor}
 $$
\\
where
$$\omega_{11} \; = \; (1 - d_{1}) \;\;  \omega_{22} \; = \; (1 - d_{2}) \;\; \omega_{33} \; = \; (1 - d_{3})$$ \vspace*{0.1cm} $$\omega_{12} \; = \; \sqrt{(1 - d_{1})(1 - d_{2})}  \;\;\omega_{23} \; = \; \sqrt{(1 - d_{2})(1 - d_{3})} \;\; \omega_{13} \; = \; \sqrt{(1 - d_{1})(1 - d_{3})}$$

\subsection{Hypothesis of Strain Equivalence}\label{Hypothesis of Strain Equivalence}

\indent\indent\indent The inelastic constitutive equation of a damaged material is given by the corresponding constitutive equation for an undamaged material by replacing the stress tensor $\sigma$ in the equation with the corresponding effective stress tensor $\tilde{\sigma}$. In Fig. the effect of stress $\sigma$ acting on RVE in the current damaged configuration $B_{t}$ is equivalent to that of the stress $\tilde{\sigma}$ in the fictitious undamaged configuration. Therefore the deformation of the damaged material subject to stress $\sigma$ should be equal to that of the fictitious undamaged material subject to stress $\tilde{\sigma}$. Suppose the constitutive equation of an undamaged inelastic material is given by
\begin{equation}
  \epsilon = F_{0}(\sigma, \alpha)
\end{equation} 
or
\begin{equation}
  \dot{\epsilon} = F_{0}(\sigma, \alpha)
\end{equation}

where $\alpha$ is an internal variable representing the internal change other than damage. and ($\dot{}$) denotes the material time derivative
\begin{figure}[htbp]
\begin{center}
\includegraphics[width=0.8\textwidth]{{6. Strain_eq.png}}
 \caption{Hypothesis of strain equivalence}
 \label{fig:Strain_eq}
 \end{center}
\end{figure}
Then according to hypothesis of strain equivalence, the inelastic constitutive equation of the damaged material represented by a damage variable $D$ should be given by replacing $\sigma$ of Eq.(25) with the effective stress $\tilde{\sigma}$ i.e.,

\begin{equation}
    	\epsilon = F(\sigma, D, \alpha)  = F_{0}(\tilde{\sigma}, \alpha)
\end{equation}

or 
\begin{equation}
    	\dot{\epsilon} = F(\sigma, D, \alpha)  = F_{0}(\tilde{\sigma}, \alpha)
\end{equation}

In case of elastic deformation, constitutive equations for an undamaged and damaged material is given by
\begin{equation}
\epsilon = \mathbb{S}_{0}\; : \sigma,
\end{equation}\\
\begin{equation}
\epsilon = \mathbb{S}(D)\; : \sigma,
\end{equation}
where $\mathbb{S}_{0}$ and $\mathbb{S}(D)$  are fourth-order elastic compliance tensors of the materials. Therefore, according to the hypothesis of strain equivalence the elastic constitutive equation of the damaged material and the compliance tensor is given by 
\begin{equation}
\epsilon = \mathbb{S}_{0}\; : \tilde{\sigma}  =  [\mathbb{S}_{0}\;: \mathbb{M} (D)]\;: \sigma = \mathbb{S}(D)\; : \sigma
\end{equation}
\begin{equation}
\mathbb{S}(D) = \mathbb{S}_{0}\; : \mathbb{M} (D)
 \label{eqn:S_HSeq}
\end{equation}
where $\mathbb{M} (D)$ is the damage effect tensor which is given by 
\begin{equation}
\mathbb{M} (D)  = \mathbb{S}_{0}^{-1} \; : \mathbb{S}(D) 
\end{equation}
The resulting compliance tensor of Eq.(\ref{eqn:S_HSeq}) has inconvenience of its asymmetry which can resolved by taking another variable $D^{*}$ besides $D$.
\begin{equation}
	\mathbb{S}^{*} (D)  = \frac{1}{2} [ \mathbb{S}_{0} \; :  \mathbb{M} (D^{*}) + \mathbb{M}^{T} (D^{*})\; : \mathbb{S}_{0} ]
\end{equation}
and
\begin{equation}
	\mathbb{M} (D^{*})  =  \frac{1}{2}  [ \mathbb{M} (D^{*}) +  \mathbb{S}_{0}^{-1}\; : \mathbb{M}^{T} (D^{*})\; : \mathbb{S}_{0} ]
\end{equation}
\subsection{Hypothesis of strain energy equivalence}\label{Hypothesis of strain energy equivalence}
\indent\indent\indent Let us consider an elastic-plastic material, and represent the internal change due to plastic deformation by an internal state variable $\alpha$. The complementary strain energy functions of the material at undamaged and damaged state are given, respectively as follows
\\
\begin{equation}
V_{0}(\sigma,\alpha) = \frac{1}{2}\sigma : \mathbb{S}_{0} : \sigma \; - \; \phi(\alpha)
\end{equation}
\\
\begin{equation}
V(\sigma,D,\alpha) = \frac{1}{2}\sigma : \mathbb{S}(D) : \sigma \; - \; \phi(\alpha)
\end{equation}
\\
Thus the constitutive equation for the undamaged and damaged material 
\\
\begin{equation}
\epsilon = \frac{\partial V_{0} }{\partial \sigma} = \mathbb{S}_{0} : \sigma
\end{equation}
\\
\begin{equation}
\epsilon = \frac{\partial V }{\partial \sigma} = \mathbb{S}(D) : \sigma
\label{eqn:Strain_energy_eq}
\end{equation}

\begin{figure}[htbp]
\begin{center}
\includegraphics[width=0.8\textwidth]{{7.Strain_energy_eq.png}}
 \caption{Hypothesis of strain energy equivalence}
 \label{fig:Strain_energy_eq}
 \end{center}
\end{figure}

Suppose a damaged material of Fig.(\ref{fig:Strain_energy_eq})a subject to stress $\sigma$, and represent the damage and internal state due to inelastic deformation by $D$ and $\alpha$, respectively. Then the strain energy function $V(\sigma,D,\alpha)$ of the damaged material is given by replacing $\sigma$ in the corresponding function $V_{0}(\sigma,\alpha)$ of the undamaged material of Fig.(\ref{fig:Strain_energy_eq})b with effective stress $\tilde{\sigma}$
\\
\begin{equation*}
V(\sigma,D,\alpha) \; = \; V_{0}(\tilde{\sigma},\alpha)
\end{equation*}
\\
By the use of this hypothesis, the elastic strain of Eq.(\ref{eqn:Strain_energy_eq}) leads to
\\
\begin{equation*}
\epsilon \; = \; \frac{\partial V(\sigma,D,\alpha)}{\partial \sigma} = \mathbb{S}(D) : \sigma 
\end{equation*}
\\
\begin{equation*}
\;\;\;\;\;\;\;\;\;\; = \; \frac{\partial V_{0}(\tilde{\sigma},\alpha)}{\partial \sigma} = \frac{\partial}{\partial \sigma}(\frac{1}{2}\tilde{\sigma} : \mathbb{S}_{0} : \tilde{\sigma} )
\end{equation*}
\\
\begin{equation*}
\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\; = \; \frac{1}{2}\frac{\partial}{\partial \sigma} [(\mathbb{M}(D):\sigma) : \mathbb{S}_{0} : (\mathbb{M}(D):\sigma)]
\end{equation*}
\\
\begin{equation}
= \;[\mathbb{M}^{T}(D) : \mathbb{S}_{0} : \mathbb{M}(D)]
\label{M_eqn}
\end{equation}
\\
From Eq.(\ref{M_eqn}), the elastic compliance tensor of the damaged material is given as follows
\\
\begin{equation}
\mathbb{S}(D) \; = \; \mathbb{M}^{T}(D) : \mathbb{S}_{0} : \mathbb{M}(D)
\label{eqn: S_HSEeq}
\end{equation}
In relation to the effective stress tensor $\tilde{\sigma}$ of Eqn.(\ref{eqn:effective_stress_tensor}) we may define a new effective strain tensor
\\
\begin{equation}
\tilde{\epsilon} \; = \; \mathbb{M}^{-T}(D) : \epsilon
\end{equation}
\\
Then the complementary strain energy function and the elastic constitutive equation can be written also in the form
\\
\begin{equation}
V = \frac{1}{2}\sigma : \epsilon \; - \; \phi(\alpha) = \frac{1}{2}\tilde{\sigma} : \tilde{\epsilon} \; - \; \phi(\alpha)
\end{equation}
\\
\begin{equation}
\tilde{\epsilon} \; = \; \mathbb{S}_{0} : \tilde{\sigma}
\end{equation}

\subsection{Elastic Constitutive equation and Elastic modulus tensor of orthotropic material}\label{Constitutive matrix}
\indent\indent\indent Orthotropic materials are materials which exhibit different material properties along three mutually-orthogonal axis. They are a special form of anisotropic materials, because their properties change when measured from different directions. Some examples of orthotropic materials are wood, composite materials etc., Orthotropic materials require 9 independent variables in order to express their constitutive matrix. The 9 elastic constants are three Young's moduli $E_{x},E_{y},E_{z}$, the three Poisson's ratios $\nu_{xy},\nu_{yz},\nu_{zx}$, and three shear moduli $G_{xy},G_{yz},G_{zx}$. The elastic stiffness matrix of orthotropic material has the form,

\begin{equation}
  \sigma = \mathbb{C}_{0} : \epsilon   or \;\;\;  \sigma_{ij}  =  C^{0}_{ijkl}\epsilon_{kl},
\end{equation}

$$
[C^{0}_{pq}] =  
 \begin{bmatrix}
  \frac{1 - \nu_{yz}\nu_{zy}}{E_{y}E_{z}\Delta} \;& \frac{\nu_{xy} + \nu_{xz}\nu_{zy}}{E_{y}E_{z}\Delta}  \;& \frac{\nu_{xz} + \nu_{xy}\nu_{yz}}{E_{y}E_{z}\Delta}  \;& 0 \;& 0 \;& 0 \\
 \\
   \frac{\nu_{yx} + \nu_{yz}\nu_{zx}}{E_{x}E_{z}\Delta}  \;&  \frac{1 - \nu_{xz}\nu_{zx}}{E_{1}E_{z}\Delta} \; & \frac{\nu_{yz} +\nu_{yx}\nu_{xz}}{E_{1}E_{z}\Delta}  \; & 0\; & 0\; & 0 \\
  \\
    \frac{\nu_{zx} + \nu_{yx}\nu_{zy}}{E_{x}E_{y}\Delta}  \;&   \frac{\nu_{zy} + \nu_{xy}\nu_{zx}}{E_{x}E_{y}\Delta} \;& \frac{1 - \nu_{xy}\nu_{yx}}{E_{x}E_{y}\Delta}  \;& 0 \;& 0 \;& 0 \\ 
\\

 
  0 \;& \nu \;& \nu \;& G_{xy} \;& 0 \;& 0 \\
  \\
  0 \;& \nu \;& \nu \;& 0 \;& G_{yz} \;& 0 \\
  \\
  0\;& \nu \;& \nu \;& 0 \;& 0 \;& G_{zx} 
 \end{bmatrix}
 $$\\
 
 where 
 \begin{align*}
 \Delta = (1 - \nu_{xy}\nu_{yx} - \nu_{yz}\nu_{zy} - \nu_{zx}\nu_{xz} - 2\nu_{xy}\nu_{yz}\nu_{zx})/E_{x}E_{y}E_{z}
 \end{align*}
   and  $\frac{\nu_{xy}}{E_{y}} = \frac{\nu_{yx}}{E_{x}}, \frac{\nu_{yz}}{E_{z}} = \frac{\nu_{zy}}{E_{y}}, \frac{\nu_{xz}}{E_{z}} = \frac{\nu_{zx}}{E_{x}}$ 

\newpage
\vspace*{2cm}
\section{Working environment}
\vspace*{1cm}
\indent\indent\indent  The material models necessary for simulating progressive damage models must be programmed first using a programming language, compiled and then can be tested in a commercial FEM software. The programming language of choice for most commercial FEM software is FORTRAN because they are simple and fast. In order to program the material model, an integrated development environment (IDE) and a compiler which is compatible with the version of the FEM software is required. In this chapter the tools required for creating material model and how to use them in order to test the models is described in detail.  
\vspace*{1cm}
\subsection{Software tools required}
\begin{itemize}
\item \textbf{OCTAVE}\\ \indent
\hspace*{13mm} Octave is an open source version of programming language software MATLAB. Initially, the user material subroutines are developed on Octave and tested using simple tests like uniaxial tension with the help of constitutive driver routines
\item \textbf{Visual studio }\\
\hspace*{13mm} Visual studio is the IDE used for programming and debugging user material subroutines using FORTRAN programming language.
\item \textbf{Intel parallel studio}\\
\hspace*{13mm} The compiler available in Intel parallel studio is used for compiling the material subroutines before testing them in an FEM software
\item \textbf{ANSYS }\\
\hspace*{13mm}ANSYS is the commercial FEM software chosen for creating specimens and analyzing how the material models behave in different test conditions
\end{itemize}

The following sections provide the reader a detailed description starting from how to develop the user defined material subroutine to how to implement and analyse the results in the ANSYS environment.  The flowchart below shows the steps involved in the whole process\\
\begin{center}
\begin{tikzpicture}[node distance = 3cm]

\node(start) [process] {Programming the UMAT};
\node(compile) [process, below of = start] {Compiling the UMAT};
\node(Model)   [process, below of = compile] {Creating FE model};
\node(solve) [process, below of = Model] {Testing the UMAT};
\node(post)[process, below of = solve] {PostProcessing};


\draw [arrow] (start) -- (compile);
\draw [arrow] (compile) -- (Model);
\draw [arrow] (Model) -- (solve);
\draw [arrow] (solve) -- (post);


\end{tikzpicture}
\label{Schematic of UMAT implementation}
\end{center}
\vspace*{0.6cm}
\subsection{Programming the UMAT}
\indent\indent\indent  The user material subroutine is an ANSYS programmable feature which allows user to write their own material constitutive equations with in a newly developed general material framework. The subroutine is called at all material integration points of the element during solution phase. ANSYS uses FORTRAN as the programming language for creating user programmable features. Therefore Visual Studio is the IDE used for developing these FORTRAN subroutines.\\
\indent\indent\indent ANSYS demands the necessary variables declared in certain way so that the USERMAT developed can work compatibly with ANSYS when it is called at each integration points. The guidelines for declaring input and output arguments can be found on ANSYS' usermat guide.  The following image shows the user subroutine interface with the set of possible input arguments that can accessed by USERMAT from ANSYS \\
\begin{figure}[htbp]
\begin{center}
\includegraphics[width=0.9\textwidth]{{9.Usermat_input}}
 \caption{Usermat Interface}
 \label{fig:Usermat Interface}
 \end{center}
\end{figure}
For every Newton raphson iteration, the USERMAT is called at every material integration point and the ANSYS passes in strains, stresses and state variables at the beginning of the time increment and the current strain increment. The USERMAT then has to compute and update the necessary output arguments like stresses and state variables at the end of the increment and the material tangent stiffness matrix $\frac{\partial \sigma}{\partial \epsilon} $.
\vspace*{0.6cm}
\subsection{Compiling UMAT}
\indent\indent\indent The user programmable subroutines must be compiled before testing them in ANSYS environment. The process of compilation first checks for errors in the source and then converts them into ANSYS executable files (.dll files) which then can be used by ANSYS. The compiler present in Intel parallel studio is used for this purpose. The step by step process of compiling the UMAT is given below
\begin{itemize}
\item Create an empty directory and copy the usermat file that you want to compile (.f files) into the empty directory.
\item Change the name of your usermat file to $usermat$
\item Go to "Control Panel$>$Search System$>$Edit the system environment variables$>$Environment variables" and click New in the user variables for your PC which opens a window
\item In that window, type ANS\_USER\_PATH for variable name and for variable value, copy and paste the path to your working directory and click Ok
\item Go to folder "C:\texttt{\textbackslash} Program Files\texttt{\textbackslash} ANSYS Inc\texttt{\textbackslash} v181\texttt{\textbackslash} ansys\texttt{\textbackslash} custom\texttt{\textbackslash} user\texttt{\textbackslash} win64" and copy the ANSUSERSHARED.bat file and paste it in the working directory
\item Open command prompt and navigate to the working directory
\item Type ANSUSERSHARED.bat and press enter. This opens the Intel compiler and asks for user-programmable feature source file name
\item Type $usermat$ without extension and press Enter.
\item If there is no error in the usermat file the compiler will show the message "usermatLib.dll has been successfully build."  
\item In order for the ANSYS to access these .dll files, open ANSYS Mechanical APDL product launcher and in the file management section browse to the current working directory
\item Click run and in the Mechanical APDL output window you shoud see the message "Note - This ANSYS version was linked by Licensee". This indicates that you are using the shared library with the USERMAT\\
\end{itemize} 

\subsection{Creating FE model}
\indent\indent\indent  The preprocessor section of the ANSYS mechanical APDL is used to create and mesh the FE model. The ANSYS user programmable feature can be used with 18x family elements, which include LINK180, PLANE 182, PLANE 183, SOLID 185, SOLID 186. The type of element required for creating FE model based on the problem can be chosen from the element type menu in preprocessor section. Once the element type is chosen the material model and the material properties can be entered in the $Material\; props$ section.  The $Modelling$ section can be utilised to create the geometry required for testing the subroutines and then can be meshed using the $Meshing$ option.\\ \indent\indent\indent In order to use the FE model again and again to test different material models with different material properties the FE model can be saved in the form of an APDL script. An APDL script is a simple text file which contains the command required to create and solve and FE model. A simple way to create an APDL script for an FE model is to copy the log of commands which were automatically created in the log file during the creation of your model and pasting it a new text file. This log file can be accessed by going to $List>Files>Logfile$. The created APDL script can then be accessed by going to $File>Read \;input\; from$ and navigate and select your file.

\subsection{Testing UMAT}
\indent\indent\indent  To use the user material option, the TB,USER command must be included in the APDL script so that the user material can be defined. The table command for USER material option is\\
\\
\textbf{TB,USER,matId,NTEMPS,NPTS}
\\
\\
\indent matId - material reference number
\\
\\
\indent NTEMPS - Number of temperature points 
\\
\\
\indent NPTS  -  Number of material constants at a given temperature
\\
\\
If state variables are used in the subroutine, the number of state variables need to be defined in the APDL script by the command TB,STATE\\
\\
\textbf{TB,STATE,matId,,NPTS}\\
\\
\indent matId - material reference number
\\
\\
\indent NPTS - Number of state variables to be used in USERMAT
\\
\\
A simple example for defining user material and two state variables is given int the Fig.(\ref{fig:Tb}) below
\begin{figure}[htbp]
\begin{center}
\includegraphics[width=0.3\textwidth]{{12.Tb}}
 \caption{Table (TB) commands}
 \label{fig:Tb}
 \end{center}
\end{figure}

Before defining boundary conditions (BCs) the entities required for solving the FE model such as time at the end of load step, number of steps, the results to be stored etc., must be defined. This can be done using $Sol'n\; Controls$ option in the solution menu. Once the BCs are defined the model can be solved by giving the command $SOLVE$. 
\vspace*{0.5cm}
\subsection{PostProcessing}
\indent\indent\indent Once the FE model has finished solving, the results then can be analyzed using the 'General Postprocessor' option. The nodal and elemental solution for components like stress, strain, displacement etc., can be plotted using the 'contour plot' option which can be found on Plot results. By default this option plots the results at last sub step, so to plot the solution at the sub step of your choice one must navigate to $Read\;results>By\;pick$ and select the substep to be plotted. Then the results of that substep can be plotted using 'contour plot' option mentioned before. Since the  posprocessor of ANSYS doesnot have GUI option for plotting state variables the following command must be given: $ plnsol,svar,n $ where $n$ is the number of the state variable to be plotted.\\
\indent\indent\indent  The time history of a certain variable such stress,reaction force, strain etc., at a node or an element can be plotted using $TimeHist\;Postpro$ option. On clicking the $TimeHist\;Postpro$ option a $Variable\;List$ window opens up. In order to add the variables to plot, click the green add symbol on the top-left corner which opens a window with the list of variables that can be added to the $Variable\;List$ window. Once the variables has been added the variables can be plotted against each other or against time. Fig.(\ref{fig:Timehist}) shows the $Variable\;List$ window with X-component of force and displacement of node 3 selected and plotted against each other.
\begin{figure}[htbp]
\begin{center}
\includegraphics[width=0.8\textwidth]{{13.Timehist}}
 \caption{Time history post processor window}
 \label{fig:Timehist}
 \end{center}
\end{figure}
The time history results of each variable at node or an element can also be saved as text file using $List\;Data$ option in the 
$Variable\;List$ window. 



\clearpage
\vspace*{4cm}
\section{Progressive Failure analysis of Orthotropic composite materials }
\subsection{Fibre-reinforced Composites}
\indent\indent\indent  Fibre reinforced plastic composites is a term for large family of materials ranging from short fibre reinforced polyesters to unidirectional graphite fibre epoxies. Fibre reinforced composites consists of three components 1) the fibres as the discontinuous or dispersed phase 2) the matrix as the continuous phase and 3) the fine inter-phase region also known as the interface. The different combination of fibre and matrix material lead to different material properties and also the manifestation of the fibres and the manufacturing techniques. The first fibres used in fibre reinforced plastics are made of glass. Although the virgin strength of the glass is high, the actual strength is limited by the microscopic defects on the surface of the fibre. The graphite fibres are anisotropic due to their laminar structure. Graphite fibres maintain their strength even at high temperatures. Two types of plastics are commonly used as matrix materials, namely unsaturated polyesters and epoxies. The use of unsaturated polyesters is restricted to temperatures upto 100C. The main advantage of this material is the high amount of shrinkage at hardening , which causes high internal stress and decrease the strength of the material.  The characteristics of epoxy are better than polyester resins. The material can withstand temperatures upto 250C and shrinks only  2\%  at hardening. But epoxy resins are high in price compared to the polyesters.

\subsection{Mechanisms of damage and failure in fibre reinforced composites}
\indent\indent\indent The failure in fibre reinforced composites happens mainly due to matrix cracking or fibre failure. Therefore the failure can be divided mainly two types namely 1) Longitudinal failure and 2) Transverse failure. The mechanism of both failure mechanisms, its causes and its effects on material behaviour are discussed in detail below

\subsubsection{Longitudinal failure}
\indent\indent\indent  In fibre-reinforced plastics, the largest portion of the load is resisted by fibres. When the fibres fail, the load must redistribute to other areas of the structure, and may cause structural collapse. In composites where strain to failure for resin matrix is higher than one of the reinforcing fibre, longitudinal failures start by isolated fibre fractures in weak zones. This kind of localized fractures increase the normal and interfacial shear stress in fibres and promote matrix cracking, fibre matrix debonding, conical shear failures etc., When the load is further increased it may lead to final collapse. Longitudinal tensile failure occurs in both constituents, and a fracture occurs along a plane whose normal is parallel to the fibre direction. A simple maximum stress or maximum strain can usually provide an accurate measure of longitudinal tensile failure. Longitudinal compressive failure occurs from the collapse of the fibres as a result of shear kinking and damage of the supporting matrix. Fibre misalignment causes shear stress between fibres that rotate fibres, which increases shear stress further and leads to instability. 

\subsubsection{Transverse failure}
\indent\indent\indent  Transverse failure happens due to matrix cracking and fibre-matrix debonding. Under the presence of in-plane shear stress and transverse tensile stress, the combined effects of defects such as resin rich regins, fibre-resin debonds, and resin voids, trigger a transverse crack that extends through the thickness. The transverse cracks are formed at fibre-resin interface without affecting the fibres. When and unidirectional fibre composite is loaded in shear, a non-linear shear stress-strain behaviour is observed before the material fails by through thickness matrix cracking. This non-linear behaviour is due to the visco-plastic behaviour of the matrix, and from the nucleation of microvoids.\\
\begin{figure}[htbp]
\begin{center}
\includegraphics[width=0.7\textwidth]{{5. FRP failure.png}}
 \caption{Fracture planes in FRP material}
 \label{fig:FRP failure}
 \end{center}
\end{figure}\\

 Experimental results have shown that moderate compression has beneficial effects on the strength of the material (Soden et al., 1998), when the transverse compressive stress value is smaller compared to the in-plane shear stress, the fracture plane is perpendicular to the mid-plane of the ply. Increasing the compressive stress changes angle of the fracture plane. For glass-epoxy and carbon-epoxy composites when loaded in pure tranverse compression, the fracture plane is at an angle of 53° $\pm$ 3° with respect to thickness direction. Therefore, the matrix cracking does not occur in the plane of maximum transverse shear stress (45°).



\subsection{Damage initiation criteria}
\indent\indent\indent  Damage initiation criteria refers to the onset of damage at a material point. Since the properties of the orthotropic materials change in mutually perpendicular direction three failure mode index, $F_{f}, F_{m}, F_{z}$, are used for failure modes in three principal material directions. Since the failure due to tension and compression in each direction cannot happen at same integration point and at the same time, the failure mode index must be calculated based on whether the material direction is under tension or compression. Both strain and stress based damage initiation criteria can be employed based on the application. Some of the damage initiation criteria are given as follows
\subsubsection{Maximum strain criteria}\label{Maximum strain criteria}
\indent\indent\indent The maximum strain criterion is a simple criterion which checks whether the strain in the given material direction exceeds the failure strain or not. The maximum strain criterion for each material direction is given below\\
\begin{table}[htbp]
  \begin{center}
     \begin{tabular}{l  c  c} 
     \hline
     \\
      \textbf{Damage direction} \;\;& \textbf{Tension} \;& \textbf{Compression}\\
      \\
      \hline
      \\
      Fibre direction 1 ($F_{f}$) & \Large{$\frac{\epsilon_{1}}{\epsilon_{t1}} $}\small{ $\leq 1$} &  \Large{$\frac{\epsilon_{1}}{\epsilon_{c1}} $}\small{ $\leq 1$}\\
      \\
      Matrix direction 2 ($F_{m}$)  &  \Large{$\frac{\epsilon_{2}}{\epsilon_{t2}} $}\small{$\leq 1$}  & \Large{$\frac{\epsilon_{2}}{\epsilon_{c2}} $}\small{$\leq 1$}\\
      \\
      Matrix direction 3 ($F_{z}$) &  \Large{$\frac{\epsilon_{3}}{\epsilon_{t3}} $}\small{$\leq 1$}  &   \Large{$\frac{\epsilon_{2}}{\epsilon_{c3}} $}\small{$\leq 1$}\\
       \\
       \hline
    \end{tabular}
    \\
    \caption{Maximum strain criterion}
    \label{tab:Maximum strain criterion}
  \end{center}
\end{table}\\
where $\epsilon_{ti}$ and $\epsilon_{ci}$ are failure strains in tension and compression respectively, in each material direction. 
\\
\subsubsection{Maximum stress criteria}\label{Maximum stress criteria}
\indent\indent\indent Since the load-carrying area decreases due to increase in damage, the effective of stress gets magnified in the damaged material. Therefore, in case of maximum stress criteria normal stress components of the effective stress($\tilde{\sigma}$) are checked against the failure strength in each principal material direction. The effective stress can computed using the Eqn.(\ref{eqn:effective_stress_tensor}). The maximum stress criteria for each material direction is given in the table below\\
\begin{table}[htbp]
  \begin{center}
     \begin{tabular}{l  c  c} 
     \hline
     \\
      \textbf{Damage direction} \;\;& \textbf{Tension} \;& \textbf{Compression}\\
      \\
      \hline
      \\
      Longitudinal direction 1 ($F_{f}$) & \Large{$\frac{\tilde{\sigma}_{11}}{X_{T}} $}\small{ $\leq 1$} & \Large{$\frac{\tilde{\sigma}_{11}}{-X_{C}} $}\small{ $\leq 1$} \\
      \\
      Transverse direction 2 ($F_{m}$)  &  \Large{$\frac{\tilde{\sigma}_{22}}{Y_{T}} $}\small{ $\leq 1$}  & \Large{$\frac{\tilde{\sigma}_{22}}{-Y_{C}} $}\small{ $\leq 1$}\\
      \\
      Transverse direction 3 ($F_{z}$) &  \Large{$\frac{\tilde{\sigma}_{33}}{Z_{T}} $}\small{ $\leq 1$}  &   \Large{$\frac{\tilde{\sigma}_{33}}{-Z_{C}} $}\small{ $\leq 1$}\\
       \\
       \hline
    \end{tabular}
    \\
    \caption{Maximum stress criterion}
    \label{tab:Maximum stress criterion}
  \end{center}
\end{table}\\
where $X_{T}$,$ Y_{T} $ and $Z_{T}$ are failure strength in tension and $X_{C}$,$ Y_{C} $ and $Z_{C}$ are failure strength in compression in each principal material direction respectively.\\
\\

\subsubsection{3D Hashin's quadratic strain criteria}\label{3D Hashin's quadratic strain criteria}
\indent\indent\indent Hashin's quadratic strain criteria includes shear strain components in addition to the normal strain components. The criteria for each material direction is given below\\

i) Longitudinal direction 1 ,
\\
\begin{equation}
\large{F_{f}^{2} =  
	\begin{cases}
	
		\Big(\frac{\epsilon_{11}}{\epsilon_{11}^{f,t}}\Big)^{2} \; + \; \Big(\frac{\epsilon_{12}}{\epsilon_{12}^{f}}\Big)^{2} \; + \; \Big(\frac{\epsilon_{13}}{\epsilon_{13}^{f}}\Big)^{2} \; \geq  \; 1  \; \; \; \; \;  (\epsilon_{11}  >  0)  \\
	\\
	\Big(\frac{\epsilon_{11}}{\epsilon_{11}^{f,c}}\Big)^{2}  \; \geq  \; 1 \; \; \; \; \; \; \;  \; \; \; \;  (\epsilon_{11}  <  0) 

	
	\end{cases}}
\end{equation}
\\
\\
ii) Transverse direction 2,
\\
\begin{equation}
\large{F_{m}^{2} =  
	\begin{cases}
	
	\frac{(\epsilon_{22} + \epsilon_{33} )^{2}}{\epsilon_{22}^{f,t} \epsilon_{33}^{f,t}}   -  \frac{\epsilon_{22}\epsilon_{33}}{(\epsilon_{23}^{f})^{2}}  +  \Big(\frac{\epsilon_{12}}{\epsilon_{12}^{f}}\Big)^{2}  + \Big(\frac{\epsilon_{13}}{\epsilon_{13}^{f}}\Big)^{2}  +  \Big(\frac{\epsilon_{23}}{\epsilon_{23}^{f}}\Big)^{2} \;\geq  \; 1 \; \; \; \; \;  (\epsilon_{22}  >  0) \\
	\\
	
	\frac{(\epsilon_{22} + \epsilon_{33} )^{2}}{\epsilon_{22}^{f,c} \epsilon_{33}^{f,c}}  +  \frac{\epsilon_{22} + \epsilon_{33}}{\epsilon_{22}^{f,c}}\Big(\frac{\epsilon_{22}^{f,c}}{2\epsilon_{12}^{f}}  -  1\Big)   -  \frac{\epsilon_{22}\epsilon_{33}}{(\epsilon_{23}^{f})^{2}}  +  \Big(\frac{\epsilon_{12}}{\epsilon_{12}^{f}}\Big)^{2}\; \; \; \; \; \; \; \; \; \; \; \;  (\epsilon_{22}  >  0) \\ 
\\	
	\; \; \; \; \; \; \; \;\; \; \; \; \; \; \; \;\; \; \; \; \; \; \; \;  \; \;\; \; \; \; \; \; \; \;\; \; \; \; \;  + \Big(\frac{\epsilon_{13}}{\epsilon_{13}^{f}}\Big)^{2}   +  \Big(\frac{\epsilon_{23}}{\epsilon_{23}^{f}}\Big)^{2} \;\geq \; 1 
	
	
	\end{cases}}
\end{equation}
\\
\\
iii) Transverse direction 3,
\\
\begin{equation}
\large{F_{z}^{2} =  
	\begin{cases}

	\Big(\frac{\epsilon_{33}}{\epsilon_{33}^{f,t}}\Big)^{2} \; + \; \Big(\frac{\epsilon_{13}}{\epsilon_{13}^{f}}\Big)^{2} \; + \; \Big(\frac{\epsilon_{23}}{\epsilon_{23}^{f}}\Big)^{2} \; \geq  \; 1 \; \; \; \; \;  (\epsilon_{33}  >  0) \\

\\
	\Big(\frac{\epsilon_{33}}{\epsilon_{33}^{f,c}}\Big)^{2} \; + \; \Big(\frac{\epsilon_{13}}{\epsilon_{13}^{f}}\Big)^{2} \; + \; \Big(\frac{\epsilon_{23}}{\epsilon_{23}^{f}}\Big)^{2} \; \geq  \; 1 \; \; \; \; \;  (\epsilon_{33}  >  0) \\



	\end{cases}}
\end{equation}
\\
\\
in which  $\LARGE{\epsilon_{ii}^{f,t}=\frac{\sigma_{i}^{f,t}}{C_{ii}}}$,  $\epsilon_{ii}^{f,c}  =   \frac{\sigma_{i}^{f,c}}{C_{ii}} \; (i = 1,2,3)$,  $\epsilon_{12}^{f}  =   \frac{\sigma_{12}^{f}}{C_{44}}$,   $\epsilon_{13}^{f}  =  \frac{\sigma_{13}^{f}}{C_{55}}$,  $\epsilon_{23}^{f}  =   \frac{\sigma_{23}^{f}}{C_{66}}$
\subsubsection{3D Hashin's stress criteria}\label{3D Hashin's stress criteria}
\indent\indent\indent Hashin's stress criteria for each principal material direction is given as follows
\\
\\
i) Longitudinal direction 1,
\\
\begin{equation}
\large{F_{f}^{2} =  
	\begin{cases}
	\Big(\frac{\tilde{\sigma}_{11}}{X_{T}}\Big)^{2} \; + \; \Big(\frac{\tilde{\sigma}_{12}}{S_{12}}\Big)^{2} \; + \; \Big(\frac{\tilde{\sigma}_{13}}{S_{13}}\Big)^{2} \; \geq  \; 1  \; \; \; \; \;  (\tilde{\sigma}_{11}  >  0)  \\
	\\
	\Big(\frac{\tilde{\sigma}_{11}}{X_{C}}\Big)^{2}  \; \geq  \; 1 \; \; \; \; \; \; \;  \; \; \; \;  (\tilde{\sigma}_{11}  <  0) 
	
	\end{cases}}
\end{equation}
\\
\\
ii) Transverse direction 2,
\\
\begin{equation}
\large{F_{m}^{2} =  
	\begin{cases} 
		\Big(\frac{\tilde{\sigma}_{22}}{Y_{T}}\Big)^{2} \; + \; \Big(\frac{\tilde{\sigma}_{12}}{S_{12}}\Big)^{2} \; + \; \Big(\frac{\tilde{\sigma}_{23}}{S_{23}}\Big)^{2} \; \geq  \; 1  \; \; \; \; \;  (\tilde{\sigma}_{22}  >  0)  \\
		\\
		\Big(\frac{\tilde{\sigma}_{22}}{Y_{C}}\Big)^{2} \; + \; \Big(\frac{\tilde{\sigma}_{12}}{S_{12}}\Big)^{2} \; + \; \Big(\frac{\tilde{\sigma}_{23}}{S_{23}}\Big)^{2} \; \geq  \; 1  \; \; \; \; \;  (\tilde{\sigma}_{22}  <  0)  \\		
	\end{cases}}
\end{equation}
\\
\\
iii) Transverse direction 3,
\\
\begin{equation}
\large{F_{z}^{2} =  
	\begin{cases} 
		\Big(\frac{\tilde{\sigma}_{33}}{Y_{T}}\Big)^{2} \; + \; \Big(\frac{\tilde{\sigma}_{13}}{S_{13}}\Big)^{2} \; + \; \Big(\frac{\tilde{\sigma}_{23}}{S_{23}}\Big)^{2} \; \geq  \; 1  \; \; \; \; \;  (\tilde{\sigma}_{33}  >  0)  \\
		\\
		\Big(\frac{\tilde{\sigma}_{33}}{Y_{C}}\Big)^{2} \; + \; \Big(\frac{\tilde{\sigma}_{13}}{S_{13}}\Big)^{2} \; + \; \Big(\frac{\tilde{\sigma}_{23}}{S_{23}}\Big)^{2} \; \geq  \; 1  \; \; \; \; \;  (\tilde{\sigma}_{33}  <  0)  \\		
	\end{cases}}
\end{equation}
\\
\\
\\
where $X_{T}$,$ Y_{T} $ and $Z_{T}$ are failure strength in tension and $X_{C}$,$ Y_{C} $ and $Z_{C}$ are failure strength in compression in each principal material direction respectively. $S_{12}$, $S_{23}$, and $S_{13}$ are shear strengths.
\subsubsection{Modified Hashin's failure criterion}\label{Modified Hashin's failure criterion}
\indent\indent\indent Modified Hashin's failure criterion for plane stress condition is given below
\\
\\
i) Longitudinal direction 1,
\\
\begin{equation}
\large{F_{f} =  
	\begin{cases}
	
		\left[ \Big(\frac{\tilde{\sigma_{11}}} {X_{T}}\Big)^{2} \; + \;\alpha . \Big(\frac{\tilde{\sigma_{12}}}{S}\Big)^{2}\right]^{\frac{1}{2}} \;  \geq  \; 1  \; \; \; \; \;  (\tilde{\sigma_{11}}  >  0)  \\
	\\
\left[ \Big(\frac{\tilde{\sigma_{11}}} {X_{C}}\Big)^{2} \; + \;\alpha . \Big(\frac{\tilde{\sigma_{12}}}{S}\Big)^{2}\right]^{\frac{1}{2}} \;  \geq  \; 1  \; \; \; \; \;  (\tilde{\sigma_{11}}  <  0)
	
	\end{cases}}
\end{equation}
\\
\\
i) Transverse direction 2,
\\
\begin{equation}
\large{F_{f} =  
	\begin{cases}
	
	\left[ 	\Big(\frac{\tilde{\sigma_{22}}} {Y_{T}}\Big)^{2} \; + \;\alpha . \Big(\frac{\tilde{\sigma_{12}}}{S}\Big)^{2} \right]^{\frac{1}{2}} \;  \geq  \; 1  \; \; \; \; \;  (\tilde{\sigma_{22}}  >  0)  \\
	\\
\left[ \Big(\frac{\tilde{\sigma_{22}}} {Y_{C}}\Big)^{2} \; + \;\alpha . \Big(\frac{\tilde{\sigma_{12}}}{S}\Big)^{2}\right]^{\frac{1}{2}} \;  \geq  \; 1  \; \; \; \; \;  (\tilde{\sigma_{22}}  <  0)
	
	\end{cases}}
\end{equation}
\\
\\
where the shear contribution factor $\alpha$ ranges from 0 to 1.

\subsection{Types of damage evolution}
\indent\indent\indent Once damage is initiated in a material point of composite material, the material property must be degraded. This results in strain-softening of the composite materials rather than strain hardening which is observed in conventional materials like metals. A number of post-damage models are proposed for progressive failure analysis and most of them belong to one of the following categories: instantaneous unloading, gradual loading, or constant stress at failure material point as shown in Fig.(\ref{fig:Types_of_damage_evolution}) \\  
\indent\indent\indent Since continuum damage mechanics is a more accurate methodology to predict the failure behaviour of composites, non-linear gradual unloading of the composite material is adopted and simulated in this work.  Therefore non-linear material properties degradation model is implemented in this work. Based on the type of damage variable chosen i.e., scalar, vector or 2nd order tensor the damage modelling can be classified into isotropic or anisotropic damage modelling. A brief description about the types of damage modelling, damage evolution equation used and material tangent stiffness etc., is given below
\begin{figure}[htbp]
\begin{center}
\includegraphics[width=0.7\textwidth]{{8.Types_of_damage_evolution}}
 \caption{Types of degradation behaviour in damaged composite materials}
 \label{fig:Types_of_damage_evolution}
 \end{center}
\end{figure}


\subsubsection{Isotropic damage}
\indent\indent\indent In case of isotropic distribution of cracks, the damage state is usually considered to be isotropic and only a scalar variable D is required to represent the damage state of the material. In this work, a damage evolution law of following form is considered for calculating damage, once the damage has initiated.\\
\\
\begin{equation}
  \large{ D \; = \; 1 - e^{-P(\tilde{\epsilon} - k)}}
  \label{eqn: isotropic_damage}
\end{equation} 
\\
where $P$ is the softening parameter which determines slope of the damage evolution, $\tilde{\epsilon}$ is 1D equivalent strain  and $k$ is the threshold value. Since the Eqn.(\ref{eqn: isotropic_damage}) is an exponential equation, the damage D evolves exponentially from 0 to 1 and the strain-softening will be an exponential decay function. Once the damage starts to evolve the material property must be degraded. Therefore the material stiffness matrix of the  damaged material is given by,\\
\begin{equation}
\large{\mathbb{C}(D) \; = \; (1  - D) \mathbb{C}_{0} }
\end{equation} 
where $\mathbb{C}_{0}$ is the material stiffness matrix of the undamaged material. Therefore the stress-strain relation for a strain softening model is given by,\\
\begin{equation}
\large{\sigma \; = \; \mathbb{C}(D) : \epsilon }  
\end{equation}
\\
The finite element equations obtained for strain-softening model is non-linear and therefore Newton-Raphson technique is used to solve the resulting system of non-linear equations. To ensure the robustness of the Newton-Raphson method, it is important to compute the material tangent constitutive tensor $\mathbb{C}_{T}$. It can be derived as follows,\\
\begin{equation*}
\large{ \mathbb{C}_{T}  \; = \;\frac{\partial \sigma}{\partial \epsilon}  }
\end{equation*}

\begin{equation*}
\large{\sigma  \; = \; f(\epsilon, D) }
\end{equation*}

\begin{equation}
\large{\mathbb{C}_{T}  \; = \; \mathbb{C}(D) + \epsilon : \Big(\frac{\partial \sigma }{\partial D} \otimes \frac{\partial D}{\partial \epsilon}  \Big)    }
\end{equation}
\\
In the above equation, the first term $\mathbb{C}(D)$ is the damaged elasticity matrix and second term is due increased damage. In the absence of damage propagation in an increment(For eg., during unloading), the material tangent tensor is equal to the damaged elasticity matrix, so the response is linearly elastic.
\subsubsection{Anisotropic damage}
\indent\indent\indent In case of orthotropic materials, the material property changes in mutually orthogonal direction. Therefore it is more appropriate to chose a second order damage tensor. In this work, a symmetric second order tensor $\underline{D}$ is chosen , whose principal directions are assumed to coincide with the principal material directions. The eigen values of the damage tensor $\underline{D}$ have a simple physical interpretation i.e., the $i^{th}$ eigen value $d_{i}$ represents the effective fractional reduction in load carrying area on planes that are perpendicular to $i^{th}$ principal material direction. The damage tensor $\underline{D}$ can be represented as,\\
$$
\underline{D} \; = \; 
 \begin{bmatrix}
  d_{1}  \;& 0  \; & 0  \\
  \\
  0 \; & d_{2} \; & 0  \\
  \\  
  0 \; & 0 \; & d_{3} \\
  
 \end{bmatrix}
 $$  
\\
The relationship between damaged and undamaged material can be established in different way which helps us derive the constitutive equation (i.e.,damaged elastic stiffness matrix) for the damaged material. In this work, hypothesis of strain energy equivalence (Section.\ref{Hypothesis of strain energy equivalence}) and hypothesis of strain equivalence (Section.\ref{Hypothesis of Strain Equivalence}) are used to derive the elastic stiffness matrix of the damaged material. According to hypothesis of strain energy equivalence, from Eqn.(\ref{eqn: S_HSEeq}) the elastic stiffness matrix of the damaged material can be derived as,\\
\begin{equation}
\mathbb{C}(D) \; = \; \mathbb{M}^{-1} : \mathbb{C}_{0} :  \mathbb{M}^{T,-1}  
\label{Damaged_elasticity_matrix_1}
\end{equation}
where $\mathbb{M}$ is the damage effect tensor from Section.(\ref{Matrix Representation of Damage effect tensors}). 

 According to hypothesis of strain equivalence, from Eqn.(\ref{eqn:S_HSeq}) the elastic stiffness matrix of the damaged material can be derived as,\\
 \begin{equation}
\mathbb{C}(D) \; = \; \mathbb{M}^{-1} : \mathbb{C}_{0}   
\label{Damaged_elasticity_matrix_2}
\end{equation}


A simple damage evolution law for each principal material direction in case of anisotropic damage is given as follows,
\begin{equation}
d_{i} = 1 - \frac{e^{-P(F_{I} - 1)} }{F_{I}}  
\label{exponential damage equation}
\end{equation}
where $d_{i}$ (i = 1,2,3) and $F_{I}$ (I = f,m,z) are damage evolution and failure index in each principal material direction respectively.
The material tangent stiffness tensor for anisotropic damage can also be derived in the same way as isotropic damage and it is given as follows
\begin{equation*}
\large{ \mathbb{C}_{T}  \; = \;\frac{\partial \sigma}{\partial \epsilon}  }
\end{equation*}

\begin{equation*}
\large{\sigma  \; = \; f(\epsilon, \underline{D}) }
\end{equation*}

\begin{equation}
\mathbb{C}_{T}  \; = \; \mathbb{C}(D) + \epsilon : \sum_{i = 1}^{3}  \Big( \frac{\partial \sigma }{\partial d_{i}} \otimes \frac{\partial d_{i}}{\partial \epsilon }\Big)
\label{Anisotropic tangent stiffness} 
\end{equation}
In the above equation, the second term(i.e., due to increased damage) must be computed only if the corresponding failure mode is active. Since the damage evolution equation $d_{i}$ depends on failure index, the term $\frac{\partial d_{i}}{\partial \epsilon }$ must be computed based on whether the damage happened during tension or compression.

\subsection{Localisation and Mesh Regularisation}\label{Mesh Regularisation}
\indent\indent\indent Finite element simulations which uses continuum damage models are susceptible to mesh dependency: when the finite element discretization is refined, the numerical problems does not converge to a physically meaningful solution of the problem. Because of the strain softening behaviour of the material, the strain tends to localize and this results in a strong mesh dependency i.e., the solution is non-objective with respective to mesh refinement and the energy dissipated  decreases with the decrease in finite element size. Merely improving the numerical solution schemes cannot alleviate the problem associated to mesh dependency and localisation. Even if the convergence to the actual solution is improved, the solution may not even make sense from physical point of view. Therefore the so called fracture energy regularization is used to reduce the mesh sensitivity. In this technique, the softening law (damage evolution law) is modified in a such a way that the amount of energy dissipated over a fully degraded finite element depends on the fracture energy of the material and the finite element size. Therefore the fracture energy($G_c$) of the material and characteristic length ($L_{c}$) of the finite element must be included in the damage evolution equations. The damage evolution equations based on fracture energy regularization
technique for each principal directions is shown below, 
\\
\\
In Longitudinal direction 1,
\begin{equation}
\mathlarger{d_{1} = 1 - \frac{e^{P_{1}(F_{f} - 1)}}{F_{f}}}
\label{d1}
\end{equation}
\\
In transverse direction 2,
\begin{equation}
\mathlarger{d_{2} = 1 - \frac{e^{P_{2}(F_{m} - 1)}}{F_{m}}}
\label{d2}   
\end{equation}
\\
In transverse direction 3,
\begin{equation}
\mathlarger{d_{3} = 1 - \frac{e^{P_{3}(F_{z} - 1)}}{F_{z}}}
\label{d3}   
\end{equation}
\\
where $\mathlarger{P_{1} = \frac{-\sigma_{11}^{f}\epsilon_{11}^{f}L_{c}}{G_{c,1}}}$, $\mathlarger{P_{2} = \frac{-\sigma_{22}^{f}\epsilon_{22}^{f}L_{c}}{G_{c,2}}}$ and $\mathlarger{P_{3} = \frac{-\sigma_{33}^{f}\epsilon_{33}^{f}L_{c}}{G_{c,3}}}$ 


\subsection{Numerical implementation of the damage model in ANSYS}
\indent\indent\indent  As discussed before, the material models necessary for simulating progressive damage failure is implemented using the ANSYS user programmable feature called USERMAT. The damage model implemented using USERMAT computes and updates the current stress and consistent tangent stiffness. The following sections deal with the numerical implementation of the damage model based on two different methods or criteria used to predict the damage initiation\\
\begin{itemize}
\item Strain based damage model 
\item Stress based damage model 
\end{itemize}
\subsubsection{Strain based damage model}
\indent\indent\indent  In case of strain based damage model, the damage initiation is predicted using current strain ($\epsilon_{n+1}$).   The USERMAT receives strains, stresses and state variables at the beginning of the time increment and the current strain increment. The following steps describe the process of implementing the damage model

\begin{itemize}
\item Calculate current strain \textbf{$$ \underline{\epsilon}_{n+1} = \underline{\epsilon}_{n} + \underline{\Delta \epsilon} $$}
\item Calculate the current degraded material stiffness matrix  \textbf{$\mathbb{C}(\underline{D}_{n})$}
\item Calculate the failure indices \textbf{$F_{I}(\underline{\epsilon})$} \;\; (Refer(Section (\ref{Maximum strain criteria}) and (\ref{3D Hashin's quadratic strain criteria})))
\item[] Check if $F_{I} \geq F_{I}$max
\item if \textbf{$F_{I}(\underline{\epsilon})<1$} \textbf{$$\underline{\sigma}_{n+1} \; = \; \mathbb{C}(\underline{D}_{n}) :  \underline{\epsilon}_{n+1} $$} \textbf{$$\mathbb{C}_{T} \; = \; \mathbb{C}(\underline{D}_{n})$$}
\item else
   	
\item[]  Calculate the damage variables using damage evolution law, \;\; (Refer Eqn (\ref{eqn:d1}) to (\ref{eqn:d3})) \textbf{$$d_{1}(F_{f}),\;d_{2}(F_{m}),\;d_{3}(F_{z})$$}
\item[]  Check if $d_{i} \geq 0 $ 
\item[]  Calculate the updated degraded stiffness based on damage variables \textbf{$$\mathbb{C}(\underline{D}_{n+1})$$}
\item[]  Calculate current stress  \textbf{$$\underline{\sigma}_{n+1} \; = \; \mathbb{C}(\underline{D}_{n+1}) :  \underline{\epsilon}_{n+1} $$}
\item[] Calculate tangent stiffness \textbf{$$\mathbb{C}_{T}  \; = \;\mathbb{C}(D) + \sum_{i = 1}^{3} \Big( \frac{\partial \mathbb{C}(D) }{\partial d_{i}} : \epsilon \otimes \frac{\partial d_{i}}{\partial \epsilon }\Big)$$}
	
\end{itemize} 


\subsubsection{Stress based damage model}
\indent\indent\indent  In case of stress based damage model, the damage initiation is predicted using effective ($\underline{\tilde{\sigma}}_{n+1}$).  The USERMAT receives strains, stresses and state variables at the beginning of the time increment and the current strain increment. The following steps describe the process of implementing the damage model

\begin{itemize}
\item Calculate the elastic stiffness matrix  \textbf{$\mathbb{C}$}
\item Calculate effective stress \textbf{$$\underline{\tilde{\sigma}}_{n+1} = \mathbb{C}_{0} : \underline{\epsilon}_{n+1} $$}
\item Calculate the failure indices \textbf{$F_{I}(\underline{\sigma})$},\;\; (Refer Section (\ref{Maximum stress criteria}), (\ref{3D Hashin's stress criteria}) and (\ref{Modified Hashin's failure criterion}))
\item[] Check if $F_{I} \geq F_{I}$max
\item if \textbf{$F_{I}(\underline{\sigma})<1$} \textbf{$$\underline{\sigma}_{n+1} \; = \; \underline{\tilde{\sigma}}_{n+1} $$} \textbf{$$\mathbb{C}_{T} \; = \; \mathbb{C}$$}
\item else
   	
\item[]  Calculate the damage variables using damage evolution law, \;\; (Refer Eqn (\ref{eqn:d1}) to (\ref{eqn:d3}))  \textbf{$$d_{1}(F_{f}),\;d_{2}(F_{m}),\;d_{3}(F_{z})$$}  	
\item[]  Check if $d_{i} \geq 0 $ 
\item[]  Calculate the updated degraded stiffness based on damage variables \textbf{$$\mathbb{C}(\underline{D}_{n+1})$$}
\item[]  Calculate current stress  \textbf{$$\underline{\sigma}_{n+1} \; = \;  M(D)^{-1}:\underline{\tilde{\sigma}}_{n+1} $$}
\item[] Calculate tangent stiffness \textbf{$$\mathbb{C}_{T}  \; = \;\mathbb{C}(D) + \sum_{i = 1}^{3} \Big( \frac{\partial \mathbb{C}(D) }{\partial d_{i}} : \epsilon \otimes \frac{\partial d_{i}}{\partial \epsilon }\Big)$$}
	
\end{itemize} 



\newpage
\subsection{Schematic of UMAT implementation}
\indent\indent\indent The flowchart below shows the schematic of the user material subroutine (USERMAT) implementation for both and strain and stress based damage model and how the subroutine interacts with the ANSYS environment.\\
\begin{center}
\begin{adjustbox}{max height=1.36\textwidth,center}
\begin{tikzpicture}[node distance = 1.8cm]

\node(straininc) [startstop] {Apply increment $\Delta\epsilon$};
\node(strainadd) [process, below of = straininc] {$\underline{\epsilon}_{n+1} = \underline{\epsilon}_{n} + \underline{\Delta\epsilon} $ \\ $\underline{\tilde{\sigma}}_{n+1} = \mathbb{C}_{0} : \underline{\epsilon}_{n+1} $};
\node(Failure)   [process, below of = strainadd] {Failure Criteria ($F_{I}(\underline{\epsilon}))$ or $F_{I}(\underline{\sigma}))$ };
\node(Damageon)  [decision, below of = Failure, yshift=-1.5cm] {Damage onset?};
\node(Damagecalc) [process, below of = Damageon, yshift=-1.8cm] {Calculate damage variables};
\node(Materialeqn)[process, below of = Damagecalc, yshift=-0.3cm] {Material constitutive equations};
\node(Tangent)[process, below of = Materialeqn, yshift=-0.5cm] { $\underline{\sigma}_{n+1} = \mathbb{C}(D):\underline{\epsilon}_{n + 1}$ \\ (or) \\$\underline{\sigma}_{n+1} = M(D)^{-1}:\underline{\tilde{\sigma}}_{n+1}$ \\ $C_{T}=\frac{\partial \Delta \sigma}{\partial \Delta \epsilon}$};
\node(abaqus)[startstop, below of = Tangent, yshift=-0.5cm] {ANSYS solver};
\node(Converge)[decision, below of = abaqus, yshift=-1cm] {Converged?};

\draw [arrow] (straininc) -- (strainadd);
\draw [arrow] (strainadd) -- (Failure);
\draw [arrow] (Failure) -- (Damageon);
\draw [arrow] (Damageon) -- node[anchor = west]{yes} (Damagecalc);
\draw [arrow] (Damagecalc) -- (Materialeqn);
\draw [arrow] (Materialeqn) -- (Tangent);
\draw [arrow] (Tangent) -- (abaqus);
\draw [arrow] (abaqus) -- (Converge);
\draw [arrow] (Damageon.east) node[xshift=0.6cm,anchor = south]{no} -| ++(1,-5.8) -- ++(-0.5,0)  (Materialeqn);

\draw [arrow] (Converge.west)node[xshift=-1.7cm,yshift=-0.3cm,anchor = north]{yes} -| node[xshift=10cm,sloped,above]{Next increment until failure or end of analysis}++(-4.5,19.9) -- ++ (4,0) (straininc); 

\draw [arrow] (Converge.east)node[xshift=1.7cm,yshift=-0.3cm,anchor = north]{no} -| node[xshift=10.5cm,sloped,below]{Iterate until convergence} ++(3.8,19.2)-- ++ (-5.9,0)  (straininc); 

\draw [arrow] (0,-16.25)-|node[xshift=6.5cm,sloped,above]{Do for each integration point}++(-4.5,15.4)--(-0,-0.9);
 
\end{tikzpicture}
\end{adjustbox}
\end{center}


\newpage
\vspace*{4cm}
\section{Results and Discussion}
\vspace*{1cm}
\subsection{Modelling Linear elastic behaviour of orthotropic materials}
\indent\indent\indent Before implementing the damage behaviour in orthotropic materials, their linear elastic behaviour must implemented which demonstrates what happens before the damage initiation. As mentioned before orthtoropic materials are special class of material whose properties change in mutually perpendicular directions. Therefore 9 independent material constants are required in order to model their elastic behaviour numerically. Table (\ref{tab:Material parameters(Integration point studies}) summarises the utilised material parameters. The constitutive matrix given in the section(\ref{Constitutive matrix}) and Hooke's law helps us model the elastic behaviour of the orthotropic materials.\\ 
\begin{figure}[htbp!]
\begin{center}
\includegraphics[width=0.6\textwidth]{{14.Linear_SvsE.png}}
 \caption{Stress-Strain relation (ANSYS vs USERMAT)}
 \label{fig:Stress-Strain Linear elastic}
 \end{center}
\end{figure}
\FloatBarrier
\indent\indent\indent The linear elastic behaviour of the orthotropic material is implemented in the USERMAT using constitutive equations and in this section the results obtained are compared against the default orthortropic material option present in ANSYS using a structural example. A bar of length 10mm and area 1mm$^2$ (b = 1mm, t =1mm) fixed at one end is chosen for the analysis. The bar is constructed using 8 node SOLID 185 elements and full integration has been used. A displacement of 1mm is applied at the free end and the results obtained using the ANSYS default and the USERMAT are presented below. The figure(\ref{fig:Stress-Strain Linear elastic}) compares the stress-strain relation of the bar obtained using both ANSYS default and USERMAT 
\begin{table}
  \begin{center}
   \resizebox{\columnwidth}{4.26cm}{
     \begin{tabular}{l l l} 
     \hline
      \textbf{Symbol} \;\;& \textbf{Material Parameter} \;& \textbf{Value}\\
      \hline
      \\
      \vspace*{0.1cm}
      $E_{1}$ & Longitudinal (fibre dominated) elastic modulus &  55000e6 $N/m^{2}$\\
      \vspace*{0.1cm}
      $E_{2}$ = $E_{3}$  & Transverse(matrix dominated) elastic modulus   & 9500e6 $N/m^{2}$ \\
      \vspace*{0.1cm}
      $\nu_{12}$ = $\nu_{13}$  & Poisson's ratio (in-plane)  & 0.33 \\
      \vspace*{0.1cm}
      $\nu_{23}$   & Poisson's ratio (Planes 2-3)  & 0.27 \\
      \vspace*{0.1cm}
      $G_{12}$ = $G_{13}$  & In-plane shear modulus  & 5500e6 $N/m^{2}$ \\
      \vspace*{0.1cm}
      $G_{23}$   & Shear modulus (Planes 2-3)   & 3000e6 $N/m^{2}$ \\
      \vspace*{0.1cm}
      $X_{t}$ & Longitudinal (fibre dominated) Tensile strength &  2500e6 $N/m^{2}$\\
      \vspace*{0.1cm}
      $X_{c}$ & Longitudinal (fibre dominated) Compressive strength &  -2000e6 $N/m^{2}$\\
      \vspace*{0.1cm}
      $Y_{t}$ & Transverse (matrix dominated) Tensile strength &  50e6 $N/m^{2}$\\
      \vspace*{0.1cm}
      $Y_{c}$ & Transverse (matrix dominated) Compressive strength &  -200e6 $N/m^{2}$\\
      \vspace*{0.1cm}
      $S_{12}$ & In-plane strength &  50e6 $N/m^{2}$\\

       \hline
    \end{tabular}
    }
    \\
    \caption{Material parameters(Integration point studies)}
    \label{tab:Material parameters(Integration point studies}
  \end{center}
\end{table}
\FloatBarrier
\begin{figure}[htbp!]
     \begin{subfigure}[b]{0.4\textwidth}
         \centering
         \includegraphics[width=1.1\textwidth]{15.Ansys_SX.png}
         \caption{X Component of Stress}
         \label{fig:X Component of Stress}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.4\textwidth}
         \centering
         \includegraphics[width=1.1\textwidth]{18.User_SX.png}
         \caption{X Component of Stress}
         \label{fig:X Component of Stress2}
     \end{subfigure}
\end{figure}
\FloatBarrier
\begin{figure}[htbp!]\ContinuedFloat     
     \begin{subfigure}[b]{0.4\textwidth}
         \centering
         \includegraphics[width=1.1\textwidth]{16.Ansys_SY.png}
         \caption{Y Component of Stress}
         \label{fig:Y Component of Stress}
     \end{subfigure}
     \hfill
      \begin{subfigure}[b]{0.4\textwidth}
         \centering
         \includegraphics[width=1.1\textwidth]{19.User_SY.png}
         \caption{Y Component of Stress}
         \label{fig:Y Component of Stress2}
     \end{subfigure}
\end{figure}
\FloatBarrier
\begin{figure}[htbp!]\ContinuedFloat     
     \begin{subfigure}[b]{0.4\textwidth}
         \centering
         \includegraphics[width=1.1\textwidth]{17.Ansys_SZ.png}
         \caption{Z Component of Stress}
         \label{fig:Z Component of Stress}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.4\textwidth}
         \centering
         \includegraphics[width=1.1\textwidth]{20.User_SZ.png}
         \caption{Z Component of Stress}
         \label{fig:Z Component of Stress2}
     \end{subfigure}
        \caption{Contour plots of the stress components $\sigma_{xx}$,$\sigma_{yy}$ and $\sigma_{zz}$ of the bar obtained using ANSYS(Figures a,c,e on the left) and USERMAT(Figures b,d,f on the right)}
        \label{fig:USERMAT}     
\end{figure}
\FloatBarrier

Figure (\ref{fig:USERMAT}) shows the contour plots of the normal stresses ($\sigma_{xx}$,$\sigma_{yy}$ and $\sigma_{zz}$ ) computed using ANSYS default and USERMAT respectively. The comparison of the stress-strain relation and contour plots between the ANSYS default and USERMAT confirms that the results obtained using both options are same and therefore further damage-intiation and damage-evolution processes can now be implemented.
\subsection*{Damage behaviour at integration point level}
\indent\indent\indent The material subroutines are first developed on octave and tested using constitutive driver routines which enables us to understand the phenomenon that happens at integration point level. In order to demonstrate the evolution of damage after damage initiation and the strain softening following simple loading cases are investigated at the integration point level.
\begin{itemize}
\item Uniaxial tension
\item Biaxial tension
\item Triaxial tension.
\end{itemize} 
After that, the material subroutines are implemented in USERMAT and tested in ANSYS environment using a 3D finite element of unit length. The finite element is subjected to the above loading cases and the results are compared against the octave implementation
\FloatBarrier
\subsection{Uniaxial tension}
\indent\indent\indent In case of uniaxial tension the normal stress is present only in one direction and the shear stresses are zero i.e., only one component(diagonal) of the stress tensor is non-zero.  In Ansys environment, uniaxial tension is achieved by applying a displacement on the finite element in a normal direction ($11$) which increases the strain $\epsilon_{11}$ linearly and the lateral(transverse) contraction is not constrained. 3D Hashin's quadratic strain criteria (Section(\ref{3D Hashin's quadratic strain criteria})) is used to predict the damage initiation and exponential damage evolution law (Eqn(\ref{exponential damage equation})) is used to calculate the damage evolution. The results obtained from Ansys and usermat are presented in the Figure(\ref{fig:Stress-Strain relation in Ansys}) and (\ref{fig:Stress-Strain relation Octave}) respectively. The figure (\ref{fig:Evolution of damage in 11 direction}) shows the evolution of damage variables.  The system is linearly elastic till the damage initiation strain and the damage is zero. Once the strain $\epsilon_{11}$ exceeds the damage initiation strain, the damage $d_{1}$ starts to evolve exponentially and the stress starts to drop due to reduction in stiffness in 11 direction.  The damage variables $d_{2}$ and $d_{3}$ are zero. The comparison between the figures (\ref{fig:Stress-Strain relation in Ansys}) and (\ref{fig:Stress-Strain relation Octave}) suggests that the material routine implemented in octave and usermat are numerically similiar to each other.
\begin{figure}[hbt!]
     \centering
     \captionsetup[subfigure]{justification=centering}
     \begin{subfigure}{0.4\textwidth}
         \centering
         \includegraphics[width=1.25\textwidth]{21.StressvsStrain_Ansys.png}
         \caption{Stress-Strain relation (ANSYS)}
         \label{fig:Stress-Strain relation in Ansys}
     \end{subfigure}
     \hfill
     \begin{subfigure}{0.4\textwidth}
         \centering
         \includegraphics[width=1.25\textwidth]{21.StressvsStrain_Octave.png}
         \caption{Stress-Strain relation (Octave)}
         \label{fig:Stress-Strain relation Octave}
     \end{subfigure}
   \caption{Evolution of stress for uniaxial tension test in 11 direction}
   \label{fig:Evolution of stress  component for a uniaxial tension test in 11 direction} 
\end{figure}
\FloatBarrier
\begin{figure}[hbt!]
\begin{center}
  \includegraphics[width=0.5\textwidth]{21.d1,d2,d3.png}
   \caption{Evolution of damage components for uniaxial tension test in 11 direction}
   \label{fig:Evolution of damage in 11 direction} 
 \end{center}    
\end{figure}
\FloatBarrier
The scalar softening parameter($P$) in the damage evolution equation(\ref{exponential damage equation}) determines the slope of the damage curve. The following figure demonstrates the influence of the softening parameter (P) in the damage evolution
\begin{figure}[hbt!]
\begin{center}
\includegraphics[width=0.6\textwidth]{{21.P_damage.png}}
 \caption{Influence of softening parameter $P$ in the damage evolution)}
 \label{fig:Influence of softening parameter P}
 \end{center}
\end{figure}
\FloatBarrier

\subsubsection*{Drawbacks of strain based damage initiation criteria}
\indent\indent\indent Since the lateral contraction is not constrained during uniaxial tension, the transverse directions experience compression due to poisson's effect i.e., $\epsilon_{22}$ and $\epsilon_{33}$ will be negative. If the compressive strength of transverse directions 2 and 3 are sufficiently low, the strains  $\epsilon_{22}$ and $\epsilon_{33}$ will exceed the damage initiation strain. This leads to damage evolution without the presence of stress in transverse directions 2 and 3. 
This phenomenon cause convergence issues and the model stops when the damage $d_{2}$ or $d_{3}$ evolve without the presence of stress. The image (\ref{fig:Convergence error}) shows the convergence issue and the failure of the model to run when the damage $d_{2}$ starts when using strain-based damage initiation criteria
\begin{figure}[htbp!]
\begin{center}
\includegraphics[width=0.4\textwidth]{{22.Convergence_error.png}}
 \caption{Convergence error due to evolution of damage $d_{2}$ without the presence of stress}
 \label{fig:Convergence error}
 \end{center}
\end{figure}
\FloatBarrier
This problem can be rectified by using stress-based damage initiation criteria. Since damage evolution depends on failure index $F$, the transverse failure indices $F_{m}$ and $F_{z}$ will be zero during uniaxial tension if the stress based damage initiation criteria is used. This results in zero damage in transverse direction. The following section presents the results obtained using stress-based damage initiation and the use of mesh regularisation in the damage evolution law.

\subsubsection*{Stress based damage initiation and mesh regularisation}
\indent\indent\indent  As mentioned in the section (\ref{Mesh Regularisation}), the strain localisation problems results in strong mesh dependency so fracture energy and characteristic length($L_{c}$) of the element has to been included in the damage evolution law in order to alleviate the problem. So the material routine is modified by changing the damage initiation criteria to maximum stress criteria(\ref{tab:Maximum stress criterion}) and including the damage evolution equations from (\ref{d1}) to (\ref{d3}). The uniaxial tension is conducted again with the above mentioned changes and with very low transverse compression strength and the results are presented below
\begin{figure}[htbp!]
     \centering
     \captionsetup[subfigure]{justification=centering}
     \begin{subfigure}{0.4\textwidth}
         \centering
         \includegraphics[width=1.25\textwidth]{22.StressvsStrain_Ansys.png}
         \caption{Stress-Strain relation (ANSYS)}
         \label{fig:Stress-Strain relation in Ansys2}
     \end{subfigure}
     \hfill
     \begin{subfigure}{0.4\textwidth}
         \centering
         \includegraphics[width=1.25\textwidth]{22.StressvsStrain_Octave.png}
         \caption{Stress-Strain relation (Octave)}
         \label{fig:Stress-Strain relation Octave2}
     \end{subfigure}
\end{figure}
\FloatBarrier
\begin{figure}[htbp!]\ContinuedFloat 
	\centering
     \begin{subfigure}{0.4\textwidth}
         \centering
         \includegraphics[width=1.25\textwidth]{22.d1,d2,d3.png}
         \caption{Evolution of damage}
         \label{fig:Evolution of damage in 11 direction2}
     \end{subfigure}
        \caption{Evolution of stress and damage components with stress-based damage initiation criteria under uniaxial tension}
        \label{fig:Evolution of stress and damage components 2}     
\end{figure}
\FloatBarrier
From figure (\ref{fig:Evolution of damage in 11 direction2}) it is evident that the damage  $d_{2}$ and $d_{3}$ are zero as a result of stress-based damage initiation because the stress components $\sigma_{22}$ and $\sigma_{33}$ are zero under uniaxial tension. While using mesh regularisation, the slope of the damage curve is determined by the characteristic length ($L_{c}$) which depends on the volume of the element. The following figure (\ref{fig:Influence of softening parameter P}) shows how the damage evolution is affected by the volume of the element,
\begin{figure}[htbp]
\begin{center}
\includegraphics[width=0.6\textwidth]{{22.V_damage.png}}
 \caption{Influence of element volume ($V$) in the damage evolution}
 \label{fig:Influence of element volume}
 \end{center}
\end{figure}
\FloatBarrier


\subsubsection*{Discussion about tangent stiffness}
\indent\indent\indent In case of uniaxial tension the components of the stress tensor other than $\sigma_{11}$ are zero. Since stress-conditions are enforced, the octave driver routine uses Newton-raphson method to determine the input strain components other than $\epsilon_{11}$ iteratively. The Newton-raphson method requires tangent stiffness for computation which can be derived using the equation (\ref{Anisotropic tangent stiffness}) for anisotropic damage. This enables us to test the derived algorithmic tangent stiffness (ATS) before implementing it in USERMAT which is then used by Ansys for solving non-linear system of equations which arise due to strain softening. The derived algorithmic tangent stiffness is verified by comparing it with the numerical tangent stiffness computed using numerical perturbation. In numerical perturbation, the coefficients of strain tensor are perturbed by a very small value i.e.,  $\Delta\epsilon_{kl}^{n+1} = \delta$ (where $\delta<<1$) and the resulting stress perturbations are calculated. 
\begin{equation}
\Delta\sigma_{ij}^{n+1} \; = \; \sigma_{ij}^{n+1}(\epsilon_{kl}^{n+1}+\delta) - \sigma_{ij}^{n+1}(\epsilon_{kl}^{n+1})
\end{equation}
Then the components of the tangent stiffness tensor can be estimated as
\begin{equation}
 C_T \;  =  \;  \frac{\Delta\sigma_{ij}^{n+1}}{\Delta\epsilon_{kl}^{n+1}}
\end{equation}
Since the material routine must be evaluated for every perturbation of $\epsilon_{kl}$ the routine has to be called six time recursively per load-step iteration. The figure (\ref{fig:Algorithmic tangent})  and (\ref{fig:Numerical perturbation}) shows the strain components $\epsilon_{22}$ and $\epsilon_{33}$ computed using algorithmic and numerical tangent stiffness which are plotted against $\epsilon_{11}$  respectively.
\begin{figure}[htbp!]
     \centering
     \begin{subfigure}{0.4\textwidth}
         \centering
         \includegraphics[width=1.25\textwidth]{22.e11vse22e33_ATS.png}
         \caption{$\epsilon_{22},\epsilon_{33}$ vs $\epsilon_{11}$ (Algorithmic tangent)}
         \label{fig:Algorithmic tangent}
     \end{subfigure}  
     \hfill
     \begin{subfigure}{0.4\textwidth}
         \centering
         \includegraphics[width=1.25\textwidth]{22.e11vse22e33_NT.png}
         \caption{$\epsilon_{22},\epsilon_{33}$ vs $\epsilon_{11}$ (Numerical perturbation)}
         \label{fig:Numerical perturbation}
     \end{subfigure}
        \caption{The Strain components $\epsilon_{22}$ and $\epsilon_{33}$ computed using algorithmic(a) and numerical tangent stiffness(b) under uniaxial tension}
        \label{fig: Algorithmic and numerical tangent stiffness under uniaxial tension}     
\end{figure}
\FloatBarrier
These comparison between above plots clearly indicates that the tangent stiffness computed using algorithmic tangent and numerical tangent are numerically similar to each other.
\subsection{Biaxial tension}
\indent\indent\indent  In case of biaxial tension, normal stresses are present only in two normal directions and all the shear stresses are zero  i.e., only two components(diagonal) of the stress tensor are non-zero. In Ansys, biaxial tension is achieved by applying same displacements in two normal directions of the finite element ($11$ and $22$ direction) and the contraction in 3rd direction ($33$) is unconstrained. The following figures shows the corresponding stress and damage components obtained from the test.
\begin{figure}[hbt!]
     \centering
     \captionsetup[subfigure]{justification=centering}
     \begin{subfigure}{0.4\textwidth}
         \centering
         \includegraphics[width=1.25\textwidth]{23.S11vsE11.png}
         \caption{$\sigma_{11}$ vs $\epsilon_{11}$}
         \label{fig:S11vsE11}
     \end{subfigure}
	\hfill
     \captionsetup[subfigure]{justification=centering}
     \begin{subfigure}{0.4\textwidth}
         \centering
         \includegraphics[width=1.25\textwidth]{23.d1.png}
         \caption{Evolution of damage $d_{1}$}
         \label{fig:Evolution of damage d1}
     \end{subfigure}
\end{figure}
\FloatBarrier
\begin{figure}[htbp!]\ContinuedFloat 
     \begin{subfigure}{0.4\textwidth}
         \centering
         \includegraphics[width=1.25\textwidth]{23.S22vsE22.png}
         \caption{$\sigma_{22}$ vs $\epsilon_{22}$}
         \label{fig:S22vsE22}
     \end{subfigure}
     \hfill
     \begin{subfigure}{0.4\textwidth}
         \centering
         \includegraphics[width=1.25\textwidth]{23.d2.png}
         \caption{Evolution of damage $d_{2}$}
         \label{fig:Evolution of damage d2}
     \end{subfigure}
    
        \caption{Evolution of stress(Figures a,c on the left) and corresponding damage(Figure b,d on the right) components under biaxial tension}
        \label{fig:Evolution of damage under biaxial tension}     
\end{figure} 
\FloatBarrier
Since the tensile strength in transverse direction is very low compared to the longitudinal direction, evolution of damage ($d_{2}$) begins very soon and simultaneously the stress component ($\sigma_{22}$) drops as seen in figures (\ref{fig:S22vsE22}) and (\ref{fig:Evolution of damage d2}).


\subsection*{Triaxial tension}
\indent\indent\indent In case of triaxial tension, the normal stresses are present in all three normal directions and all the shear stresses are zero i.e., only diagonal components of the stress tensor are non-zero.  In Ansys, triaxial tension is achieved by applying same displacement in all three normal directions ($11$, $22$ and $33$ direction). The following figures shows the corresponding stress and damage components obtained from the test
\begin{figure}[htbp!]
       \captionsetup[subfigure]{justification=centering}
     \begin{subfigure}{0.4\textwidth}
        \centering
         \includegraphics[width=1.2\textwidth]{24.S11vsE11.png}
         \centering
         \caption{$\sigma_{11}$ vs $\epsilon_{11}$}
         \label{fig:S11vsE11 2}
     \end{subfigure}
     \hfill
     \captionsetup[subfigure]{justification=centering}
     \begin{subfigure}{0.4\textwidth}
         \centering
         \includegraphics[width=1.2\textwidth]{24.d1.png}
         \centering
         \caption{Evolution of damage $d_{1}$}
         \label{fig:Evolution of damage d1 2}
     \end{subfigure}
\end{figure}
\FloatBarrier
\begin{figure}[htbp!]\ContinuedFloat 
     \begin{subfigure}{0.4\textwidth}
         \centering
         \includegraphics[width=1.2\textwidth]{24.S22vsE22.png}
         \caption{$\sigma_{22}$ vs $\epsilon_{22}$}
         \label{fig:S22vsE22 2}
     \end{subfigure}   
     \hfill
     \begin{subfigure}{0.4\textwidth}
         \centering
         \includegraphics[width=1.2\textwidth]{24.d2.png}
         \caption{Evolution of damage $d_{2}$}
         \label{fig:Evolution of damage d2 2}
     \end{subfigure}
\end{figure}
\FloatBarrier
\begin{figure}[htbp!]\ContinuedFloat
     \begin{subfigure}{0.4\textwidth}
         \centering
         \includegraphics[width=1.2\textwidth]{24.S33vsE33.png}
         \caption{$\sigma_{33}$ vs $\epsilon_{33}$}
         \label{fig:S33vsE33}
     \end{subfigure}
     \hfill
     \begin{subfigure}{0.4\textwidth}
         \centering
         \includegraphics[width=1.2\textwidth]{24.d2.png}
         \caption{Evolution of damage $d_{3}$}
         \label{fig:Evolution of damage d3}
     \end{subfigure}     
        \caption{Evolution of stress(Figures a,c,e on the left) and corresponding(Figures b,d,f on the right) damage components under triaxial tension}
        \label{fig:Evolution of damage under triaxial tension}     
\end{figure}
\FloatBarrier
Since the material properties are same in $22$ and $33$ direction and the tensile strength is very low compared to the longitudinal direction, the damage $d_{2}$ and $d_{3}$ evolves simultaneously (Fig (\ref{fig:Evolution of damage d2 2}) and (\ref{fig:Evolution of damage d3})) and very soon as expected. Therefore the stress components $\sigma_{22}$ and $\sigma_{33}$ drops very soon as shown in the figure (\ref{fig:S22vsE22 2}) and (\ref{fig:S33vsE33}) 

\subsection{Representative structural examples}
\indent\indent\indent The following structural examples are used to test the damage model developed in UMAT in the ANSYS environment
\begin{itemize}
\item Notched tensile specimen (2D-Plane stress)
\item Compact tension(CT) specimen (2D-Plane stress)
\item Plate with hole (3D)
\end{itemize}
Each model is chosen to represent specific features of the damage model. These features include at first the capability of the model to represent damage initiation and propagation and secondly the calculate multiple damage variables i.e., the ability to show anisotropic damage development in the composite material when a load is applied(damage plots of multiple damage variable) in both 2D and 3D. Furthermore, mesh convergence studies are done in order to show that the regularization scheme used gives better results than non-regularized model. For all the finite element simulations of the above models, linear quadrilateral elements are used (both 2D and 3D) with full Gauss integration. Line search option has been enabled during all simulations in order to get good convergence. The material parameters used for the finite element simulations are given in the Table (\ref{tab:Material parameters(Representative structural examples)})
\begin{table}[!htbp]
  \begin{center}
     \resizebox{\columnwidth}{4.26cm}{
     \vspace*{0.2cm}
     \begin{tabular}{l l l} 
     \hline
     \vspace*{0.2cm}
      \textbf{Symbol} \;\;& \textbf{Material Parameter} \;& \textbf{Value}\\
      \hline
      \vspace*{0.1cm}
      $E_{1}$ & Longitudinal (fibre dominated) elastic modulus &  55.8 GPa\\
      \vspace*{0.1cm}
      $E_{2}$ = $E_{3}$  & Transverse(matrix dominated) elastic modulus   & 54.9 GPa \\
      \vspace*{0.1cm}
      $\nu_{12}$ & Poisson's ratio   & 0.043 \\
      \vspace*{0.1cm}
      $G_{12}$   &  Shear modulus  & 4.2 GPa \\
      \vspace*{0.1cm}
      $X_{t}$ & Longitudinal (fibre dominated) Tensile strength & 910.1 MPa\\
      \vspace*{0.1cm}
      $X_{c}$ & Longitudinal (fibre dominated) Compressive strength & -710.2 MPa\\
      \vspace*{0.1cm}
      $Y_{t}$ & Transverse (matrix dominated) Tensile strength & 772.2 MPa\\
      \vspace*{0.1cm}
      $Y_{c}$ & Transverse (matrix dominated) Compressive strength &  -703.3 MPa\\
      \vspace*{0.1cm}
      $S_{12}$ & In-plane strength &  131 MPa\\
      \vspace*{0.1cm}
      $G_{f}^{ft}$ & Tensile fracture energy along Longitudinal direction  &  125 KJ/$m^{2}$\\
      \vspace*{0.1cm}
      $G_{f}^{fc}$ & Compressive fracture energy along Longitudinal direction  &  250 KJ/$m^{2}$\\
      \vspace*{0.1cm}
      $G_{f}^{mt}$ & Tensile fracture energy along Transverse direction  &  95 KJ/$m^{2}$\\
      \vspace*{0.1cm}
      $G_{f}^{mc}$ & Compressive fracture energy along Transverse direction  & 254 KJ/$m^{2}$\\
       \hline
    \end{tabular}
    }
    \\
    \caption{Material parameters(Representative structural examples)}
    \label{tab:Material parameters(Representative structural examples)}
  \end{center}
\end{table}
\FloatBarrier
\subsubsection{Notched tensile specimen}
\indent\indent\indent   The first example will demonstrate the model's capability to represent damage initiation and propagation. Because of the symmetry only one quarter of the specimen is modelled in the finite element analysis. The appropriate symmetry boundary conditions has been applied at the axis of the symmetry and the geometry and boundary conditions are shown in the Figure(\ref{fig:NT Specimen}). The meshes consists of plane-stress elements with bilinear interpolations for displacements and 2*2 Gauss integration has been utilized. Three different finite element meshes have been used in the fracture zone with the elements of h=1mm, 0.5mm, 0.25mm and a total of 500, 840, 1460 elements respectively for the convergence studies (Figure \ref{fig:Considered meshes}).  At first the longitudinal direction is kept parallel to the loading direction and the behaviour of the model is analysed by applying displacement controlled load ($U_{x}$) in the longitudinal direction (X-direction). The strength in the longitudinal direction is mostly determined by the presence of fibres which has more tensile strength compared to the polymer matrix.
\begin{figure}[htbp!]
\begin{center}
\includegraphics[width=0.6\textwidth]{{25.Geometry.jpg}}
 \caption{Specimen geometry and boundary conditions. Dimensions are given in mm. Displacement controlled loading $U_{x}$ is applied}
 \label{fig:NT Specimen}
 \end{center}
\end{figure}
\FloatBarrier
\indent\indent\indent  The force-displacement response for the three different meshes with and without the regularization (Section(\ref{Mesh Regularisation})) schemes have been plotted in the Figure (\ref{fig:with regularization})  and (\ref{fig:without regularization}) respectively. The global-force displacement response is characterized by a large linear regime followed by a gradual drop of load (because of the softening) or sudden drop in case of no regularization. From figure  and it is clearly evident that the model with regularization gives stable force-displacement response when compared to the model without regularization where the maximum load capacity is very low and the the load drops significantly with decrease in mesh size(or increase in number of elements). Even though the regularization scheme does not fully alleviate the mesh dependency, it improves the solution significantly compared to no regularization. \\
\begin{figure}[htbp!]
     \centering
     \captionsetup[subfigure]{justification=centering}
     \begin{subfigure}{0.27\textwidth}
         \centering
         \includegraphics[width=1.13\textwidth]{25.1mm2.png}
         \caption{h=1mm, n=500 elements}
         \label{fig:1mm}
     \end{subfigure}
     \hfill
     \begin{subfigure}{0.27\textwidth}
         \centering
         \includegraphics[width=1.25\textwidth]{25.0.5mm2.png}
         \caption{h=0.5mm, n=840 elements}
         \label{fig:0.5mm}
     \end{subfigure}
     \hfill
     \begin{subfigure}{0.27\textwidth}
         \centering
         \includegraphics[width=1.25\textwidth]{25.0.25mm2.png}
         \caption{h=0.25mm, n=1460 elements}
         \label{fig:0.25mm}
     \end{subfigure}
    \caption{Considered meshes (h is the length of the element along fracture zone and n the total number of elements) }
    \label{fig:Considered meshes}
\end{figure}
\FloatBarrier
\begin{figure}[htbp!]
     \centering
     \captionsetup[subfigure]{justification=centering}
     \begin{subfigure}{0.45\textwidth}
         \centering
         \includegraphics[width=1.28\textwidth]{25.FvsD.png}
         \caption{model with regularization}
         \label{fig:with regularization}
     \end{subfigure}
     \hfill
     \begin{subfigure}{0.45\textwidth}
         \centering
         \includegraphics[width=1.3\textwidth]{25.FvsD2.png}
         \caption{model without regularization}
         \label{fig:without regularization}
     \end{subfigure}
    \caption{Convergence study: Global force-displacement response for model with regularization(Figures a,c,e on the left) and without regularization(Figures b,d,f on the right) }
    \label{fig:Convergence study}
\end{figure}
\FloatBarrier
 
\indent\indent\indent The damage distributions at the end of the process have been plotted for the three different meshes in the Figure (\ref{fig:Convergence study for model with and without regularization}). For numerical reasons the maximum damage is limited to a value of $d_{max}$ = 0.9999. The improvement in the global response by using regularization schemes has been illustrated by the damage distributions at the end of the loading process. A relatively large portion of the fracture zone takes part in damage process, instead of very few elements (one or two elements) in case of no regularization. Damage initiates at the tip of the blunt notch and propagates in the direction perpendicular to the loading direction. The width of the damage zone is approximately same in the three discretizations but the number of elements which reaches a critical damage value (red) increases with increase in number of elements along the fracture zone.
\begin{figure}[htbp!]
       \captionsetup[subfigure]{justification=centering}
     \begin{subfigure}{0.4\textwidth}
        \centering
         \includegraphics[width=8.25cm,height=8cm,keepaspectratio]{25.d1-1-r.png}
         \centering
         \caption{h = 1mm}
         \label{fig:d1-1-r}
     \end{subfigure}
     \hfill
     \captionsetup[subfigure]{justification=centering}
     \begin{subfigure}{0.4\textwidth}
         \centering
         \includegraphics[width=8.2cm,height=8cm,keepaspectratio]{25.d1-1-nr.png}
         \centering
         \caption{h = 1mm}
         \label{fig:d1-1-nr}
     \end{subfigure}
\end{figure}
\FloatBarrier
\begin{figure}[htbp!]\ContinuedFloat 
     \begin{subfigure}{0.4\textwidth}
         \centering
         \includegraphics[width=8.25cm,height=8cm,keepaspectratio]{25.d1-0.5-r.png}
         \caption{h = 0.5mm}
         \label{fig:d1-0.5-r}
     \end{subfigure}   
     \hfill
     \begin{subfigure}{0.4\textwidth}
         \centering
         \includegraphics[width=8.2cm,height=8cm,keepaspectratio]{25.d1-0.5-nr.png}
         \caption{h = 0.5mm}
         \label{fig:d1-0.5-nr}
     \end{subfigure}
\end{figure}
\FloatBarrier
\begin{figure}[htbp!]\ContinuedFloat
     \begin{subfigure}{0.4\textwidth}
         \centering
         \includegraphics[width=8.3cm,height=8.2cm,keepaspectratio]{25.d1-0.25-r.png}
         \caption{h = 0.25mm}
         \label{fig:d1-0.25-r}
     \end{subfigure}
     \hfill
     \begin{subfigure}{0.4\textwidth}
         \centering
         \includegraphics[width=8.2cm,height=8cm,keepaspectratio]{25.d1-0.25-nr.png}
         \caption{h = 0.25mm}
         \label{fig:d1-0.25-nr}
     \end{subfigure}     
        \caption{Convergence study for model with(Figure a,c,e) and without(b,d,f) regularization: Damage contour plots $d_{1}$ at the end of the loading}
        \label{fig:Convergence study for model with and without regularization}     
\end{figure}
\FloatBarrier
Now the transverse direction is kept parallel to the loading direction and the behaviour of the damage model i.e.,initiation and propagation of damage $d_{2}$ is analysed by applying loading in the transverse direction. The strength in the transverse direction is mostly determined by the presence of the polymer matrix which has less tensile strength compared to the fibres in longitudinal direction. The damage($d_{2}$) at the end of the loading process is shown in the Figure (\ref{fig:Damage contour plots d2})\\
\begin{figure}[htbp!]
     \centering
     \captionsetup[subfigure]{justification=centering}
     \begin{subfigure}{0.3\textwidth}
         \centering
         \includegraphics[width=5.6cm,height=5.8cm,keepaspectratio]{25.d2-1.png}
         \caption{h=1mm}
         \label{fig:d2-1}
     \end{subfigure}
     \hfill
     \begin{subfigure}{0.3\textwidth}
         \centering
         \includegraphics[width=5.6cm,height=5.8cm,keepaspectratio]{25.d2-0.5.png}
         \caption{h=0.5mm}
         \label{fig:d2-0.5}
     \end{subfigure}
     \hfill
     \begin{subfigure}{0.3\textwidth}
         \centering
         \includegraphics[width=5.8cm,height=6cm,keepaspectratio]{25.d2-0.25.png}
         \caption{h=0.25mm}
         \label{fig:d2-0.25}
     \end{subfigure}
    \caption{Damage contour plots $d_{2}$ at the end of the loading (Loading in transverse direction) }
    \label{fig:Damage contour plots d2}
\end{figure}
\FloatBarrier
 The damage pattern looks similar to the damage ($d_{1}$) when loaded in longitudinal direction i.e., large portion of the fracture zone got damaged and the no of elements reaching critical damage increase with increase in no of elements. The force-displacement response of both longitudinal and transverse loading for a single mesh type(h = 0.5mm) is compared in the Figure (\ref{fig:Strength}). As expected the strength in longitudinal direction is high compared to the transverse direction because of the high tensile strength of the fibres in longitudinal direction.
\begin{figure}[htbp!]
\begin{center}
\includegraphics[width=0.7\textwidth]{{25.Strength.png}}
 \caption{Comparison of force-displacement response in longitudinal and transverse direction for h=0.5mm discretization}
 \label{fig:Strength}
 \end{center}
\end{figure}
\FloatBarrier 
 
\subsubsection{Compact Tension (CT) Specimen}
\indent\indent\indent  This second example will demonstrate the model's ability to calculate multiple damage variables simultaneously i.e., to show the anisotropic damage development when a load is applied. In Plane stress(2D) setting the material is considered to be transversely isotropic therefore two damage variables are used to show the anisotropic damage development. The Compact Tension test is a standard test for plane fracture of materials and for the measurement of fatigue crack growths. Because of the symmetry only one half of the specimen is modelled and the geometry and appropriate boundary conditions are given in the Figure (\ref{fig:CT Specimen}). The mesh consists of plane stress(PLANE 182) elements with bilinear interpolations for displacements and 2*2 Gauss integration has been utilized. Just like the previous test, three different finite element meshes have been used in the fracture zone with the elements of h=1mm, 0.5mm and 0.25mm and a total of 509, 1409, 4811 elements respectively for the convergence studies (Figure \ref{fig:Considered meshes 2}).  A node is created at the center of the pinhole and the innermost nodes of the pinhole contour are connected to this node by coupling option in ANSYS. Now the displacement controlled load ($U_{x}$) is applied at the central and the global force-displacement response can be obtained from this central node.  At first the longitudinal direction is kept parallel to the loading direction and the behaviour of the model is analysed.\\
\indent\indent\indent  The global force-displacement response has been plotted for the three different meshes in the Figure(\ref{fig:CT Specimen FvsD}). As expected the maximum load capacity decreases with decrease in mesh size(or increase in number of elements) because of the mesh dependence of the damage evolution law. The damage distributions of the damage variables $d_{1}$ and $d_{2}$ at the end of the end of the loading process for the three different meshes has been plotted in the Figure(\ref{fig: Damage contour plots d1 and d2}). The damage $d_{1}$ is caused by tension in longitudinal direction and $d_{2}$ by tension in transverse direction.   

\begin{figure}[htbp!]
\begin{center}
\includegraphics[width=0.8\textwidth]{{26.Geometry.jpg}}
 \caption{Specimen geometry and boundary conditions. Dimensions are given in mm. Displacement controlled loading $U_{x}$ is applied}
 \label{fig:CT Specimen}
 \end{center}
\end{figure}
\FloatBarrier  


\begin{figure}[htbp!]
\begin{center}
\includegraphics[width=0.8\textwidth]{{26.FvsD.png}}
 \caption{Convergence study: Global force-displacement response for three different meshes}
 \label{fig:CT Specimen FvsD}
 \end{center}
\end{figure}
\FloatBarrier

\begin{figure}[htbp!]
     \centering
     \captionsetup[subfigure]{justification=centering}
     \begin{subfigure}{0.35\textwidth}
         \centering
         \includegraphics[width=7.5cm,height=7cm,keepaspectratio]{26.h=1mm.png}
         \caption{h=1mm, n= 509 elements}
         \label{fig:1mm}
     \end{subfigure}
     \hfill
     \begin{subfigure}{0.35\textwidth}
         \centering
         \includegraphics[width=7.5cm,height=7cm,keepaspectratio]{26.h=0.5mm.png}
         \caption{h=0.5mm, n= 1409 elements}
         \label{fig:0.5mm}
     \end{subfigure}
     \hfill
     \begin{subfigure}{0.35\textwidth}
         \centering
         \includegraphics[width=7.5cm,height=7cm,keepaspectratio]{26.h=0.25mm.png}
         \caption{h=0.25mm, n= 4811 elements}
         \label{fig:0.25mm}
     \end{subfigure}
    \caption{Considered meshes (h is the length of the element along fracture zone and n the total number of elements) }
    \label{fig:Considered meshes 2}
\end{figure}
\FloatBarrier




\begin{figure}[htbp!]
       \captionsetup[subfigure]{justification=centering}
     \begin{subfigure}{0.4\textwidth}
        \centering
         \includegraphics[width=8.25cm,height=8cm,keepaspectratio]{26.d1-1.png}
         \centering
         \caption{d1, h = 1mm}
         \label{fig:d1-1}
     \end{subfigure}
     \hfill
     \captionsetup[subfigure]{justification=centering}
     \begin{subfigure}{0.4\textwidth}
         \centering
         \includegraphics[width=8.2cm,height=8cm,keepaspectratio]{26.d2-1.png}
         \centering
         \caption{d2, h = 1mm}
         \label{fig:d2-1}
     \end{subfigure}
\end{figure}
\FloatBarrier
\begin{figure}[htbp!]\ContinuedFloat 
     \begin{subfigure}{0.4\textwidth}
         \centering
         \includegraphics[width=8.25cm,height=8cm,keepaspectratio]{26.d1-0.5.png}
         \caption{d1, h = 0.5mm}
         \label{fig:d1-0.5}
     \end{subfigure}   
     \hfill
     \begin{subfigure}{0.4\textwidth}
         \centering
         \includegraphics[width=8.2cm,height=8cm,keepaspectratio]{26.d2-0.5.png}
         \caption{d2, h = 0.5mm}
         \label{fig:d2-0.5}
     \end{subfigure}
\end{figure}
\FloatBarrier
\begin{figure}[htbp!]\ContinuedFloat
     \begin{subfigure}{0.4\textwidth}
         \centering
         \includegraphics[width=8.3cm,height=8.2cm,keepaspectratio]{26.d1-0.25.png}
         \caption{d1, h = 0.25mm}
         \label{fig:d1-0.25}
     \end{subfigure}
     \hfill
     \begin{subfigure}{0.4\textwidth}
         \centering
         \includegraphics[width=8.2cm,height=8cm,keepaspectratio]{26.d2-0.25.png}
         \caption{d2, h = 0.25mm}
         \label{fig:d2-0.25}
     \end{subfigure}     
        \caption{Damage distributions at the end of loading: Damage contour plots $d_{1}$ and $d_{2}$ }
        \label{fig: Damage contour plots d1 and d2}     
\end{figure}
\FloatBarrier 


\begin{figure}[htbp!]
\begin{center}
\includegraphics[width=0.7\textwidth]{{26.Strength.png}}
 \caption{Comparison of force-displacement response in longitudinal and transverse direction for h=0.5mm discretization}
 \label{fig:Strength2}
 \end{center}
\end{figure}

\subsubsection*{Effect of shear in damage}


\begin{figure}[htbp!]
\begin{center}
\includegraphics[width=0.7\textwidth]{{26.FvsD_alphas.png}}
 \caption{Comparison of force-displacement response for different shear co-efficient ($\alpha$) (h=1mm discretization)}
 \label{fig:FvsD_alphas}
 \end{center}
\end{figure}



\begin{figure}[htbp!]
       \captionsetup[subfigure]{justification=centering}
     \begin{subfigure}{0.4\textwidth}
        \centering
         \includegraphics[width=8.25cm,height=8cm,keepaspectratio]{26.d2-1.png}
         \centering
         \caption{$\alpha$ = 0}
         \label{fig:d1-a_0}
     \end{subfigure}
     \hfill
     \captionsetup[subfigure]{justification=centering}
     \begin{subfigure}{0.4\textwidth}
         \centering
         \includegraphics[width=8.2cm,height=8cm,keepaspectratio]{26.d2_a_0.1.png}
         \centering
         \caption{$\alpha$ = 0.1}
         \label{fig:d2-a_0.1}
     \end{subfigure}
\end{figure}
\FloatBarrier
\begin{figure}[htbp!]
       \captionsetup[subfigure]{justification=centering}
     \begin{subfigure}{0.4\textwidth}
        \centering
         \includegraphics[width=8.25cm,height=8cm,keepaspectratio]{26.d2_a_0.2.png}
         \centering
         \caption{$\alpha$ = 0.2}
         \label{fig:d1-a_0.2}
     \end{subfigure}
     \hfill
     \captionsetup[subfigure]{justification=centering}
     \begin{subfigure}{0.4\textwidth}
         \centering
         \includegraphics[width=8.2cm,height=8cm,keepaspectratio]{26.d2_a_0.3.png}
         \centering
         \caption{$\alpha$ = 0.3}
         \label{fig:d2-a_0.3}
     \end{subfigure}
\end{figure}
\FloatBarrier
\begin{figure}[htbp!]
       \captionsetup[subfigure]{justification=centering}
     \begin{subfigure}{0.4\textwidth}
        \centering
         \includegraphics[width=8.25cm,height=8cm,keepaspectratio]{26.d2_a_0.5.png}
         \centering
         \caption{$\alpha$ = 0.5}
         \label{fig:d1-a_0.5}
     \end{subfigure}
        \caption{Damage distributions at the end of loading: Damage contour plots $d_{2}$ for different shear co-efficient ($\alpha$)}
        \label{fig: Damage contour plots alpha} 
\end{figure}
\FloatBarrier


\end{document}
